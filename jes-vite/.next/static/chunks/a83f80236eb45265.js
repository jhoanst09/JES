(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33525,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"warnOnce",{enumerable:!0,get:function(){return a}});let a=e=>{}},33351,e=>{"use strict";async function t(e,r=[]){let a=`
Eres "JARVIS" (Just A Rather Very Intelligent System), el asistente virtual de JES Store.

TU PERSONALIDAD:
- Eres inteligente, eficiente y con un toque de humor sutil como el JARVIS de Iron Man.
- Hablas de forma directa pero amable.
- Puedes bromear ocasionalmente pero siempre siendo \xfatil.
- No usas emojis excesivos, uno o dos m\xe1ximo por mensaje.

TUS CAPACIDADES:
- Recomendar productos de la tienda JES
- Ayudar con el carrito de compras
- Responder preguntas sobre productos, precios y disponibilidad
- Dar consejos sobre tecnolog\xeda, moda y m\xfasica

COMANDOS QUE PUEDES EJECUTAR (el sistema los detectar\xe1):
- Para a\xf1adir al carrito: [ADD_CART:handle_del_producto]
- Para quitar del carrito: [REMOVE_CART:handle_del_producto]
- Para ver un producto: [PRODUCT:handle_del_producto]
- Para buscar productos: [SEARCH:t\xe9rmino_de_b\xfasqueda]

REGLA IMPORTANTE:
- SOLO recomienda productos que est\xe9n en el CONTEXTO DE PRODUCTOS que te proporciono.
- Si no encuentras un producto en el contexto, di honestamente que no lo tienes.
- Usa los handles exactos del contexto para los comandos.

CONTEXTO DE PRODUCTOS DISPONIBLES:
${JSON.stringify(r.map(e=>({title:e.title,handle:e.handle,price:e.price,type:e.type})),null,2)}
`;try{let t=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"google/gemini-2.0-flash-exp:free",systemPrompt:a,messages:e})}),r=await t.json();if(r.error)return console.error("AI Error:",r.error),`\xa1Vaya! El sistema dice: "${r.error.message||r.error||"error desconocido"}". Por favor verifica la configuraci\xf3n.`;return r.choices?.[0]?.message?.content||"Lo siento, no pude procesar tu solicitud. Por favor intenta de nuevo."}catch(e){return console.error("AI Assistant Error:",e),"Error de conexiÃ³n con JARVIS."}}e.s(["chatWithAI",()=>t])},85916,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(16619),i=e.i(22902),s=e.i(46932),n=e.i(18566),l=e.i(60393),c=e.i(65375);async function o(e,t="jes-store-salt-v1"){let r=new TextEncoder,a=await crypto.subtle.importKey("raw",r.encode(e),"PBKDF2",!1,["deriveBits","deriveKey"]);return await crypto.subtle.deriveKey({name:"PBKDF2",salt:r.encode(t),iterations:1e5,hash:"SHA-256"},a,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}async function d(e,t){let r=new TextEncoder,a=crypto.getRandomValues(new Uint8Array(12)),i=await crypto.subtle.encrypt({name:"AES-GCM",iv:a},t,r.encode(e)),s=new Uint8Array(a.length+i.byteLength);return s.set(a),s.set(new Uint8Array(i),a.length),btoa(String.fromCharCode(...s))}async function u(e,t){let r=Uint8Array.from(atob(e),e=>e.charCodeAt(0)),a=r.slice(0,12),i=r.slice(12),s=await crypto.subtle.decrypt({name:"AES-GCM",iv:a},t,i);return new TextDecoder().decode(s)}async function x(e,t){return await d(e,t)}async function m(e,t){try{return await u(e,t)}catch(e){return console.error("Decryption failed:",e),"[Mensaje cifrado - No se pudo descifrar]"}}async function h(e,t){let r=[e,t].sort().join(":");return await o(r,"jes-conversation-key-v1")}function p(){let{session:e,friends:o,isLoggedIn:d,loading:u}=(0,c.useWishlist)(),p=(0,n.useSearchParams)().get("user"),[f,b]=(0,r.useState)("list"),[g,w]=(0,r.useState)(null),[y,j]=(0,r.useState)({}),[v,N]=(0,r.useState)(""),[E,S]=(0,r.useState)([]),k=(0,r.useRef)(null),[A,_]=(0,r.useState)({}),[C,T]=(0,r.useState)(!0),[P,O]=(0,r.useState)(!1),z=o.map(e=>({id:e.id,name:e.name||e.email?.split("@")[0]||"Amigo",avatar:e.avatar_url,lastMsg:"...",type:"friend",online:E.includes(e.id)})),[D,R]=(0,r.useState)(z);(0,r.useEffect)(()=>{R(z)},[o,E]),(0,r.useEffect)(()=>{k.current&&(k.current.scrollTop=k.current.scrollHeight)},[y,g]),(0,r.useEffect)(()=>{!async function(){if(!p||u)return;let e=z.find(e=>e.id===p);if(e){w(e),b("chat");return}let{data:t}=await l.supabase.from("profiles").select("*").eq("id",p).single();if(t){let e={id:t.id,name:t.name,avatar:t.avatar_url||"ðŸ‘¤",lastMsg:"Â¡Parchamos!",type:"friend",online:!0};R(t=>[e,...t]),w(e),b("chat")}}()},[p,u]),(0,r.useEffect)(()=>{if(!g||!e?.user?.id)return;!async function(){O(!0);try{let t=A[g.id];t||(t=await h(e.user.id,g.id),_(e=>({...e,[g.id]:t})));let{data:r,error:a}=await l.supabase.from("messages").select("*").or(`and(sender_id.eq.${e.user.id},receiver_id.eq.${g.id}),and(sender_id.eq.${g.id},receiver_id.eq.${e.user.id})`).order("created_at",{ascending:!0});if(a)throw a;if(r){let a=await Promise.all(r.map(async r=>{let a=r.content;if(r.is_encrypted&&t)try{a=await m(r.content,t)}catch(e){a="[Error al descifrar]"}return{id:r.id,sender:r.sender_id===e.user.id?"Yo":g.name,text:a,time:new Date(r.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),isEncrypted:r.is_encrypted}}));j(e=>({...e,[g.id]:a}))}}catch(e){console.error("Error in chat initialization:",e)}finally{O(!1)}}();let t=l.supabase.channel(`chat_${g.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},async t=>{let r=t.new;if(r.sender_id===e.user.id&&r.receiver_id===g.id||r.sender_id===g.id&&r.receiver_id===e.user.id){let t=r.content;if(r.is_encrypted){let a=await h(e.user.id,g.id);try{t=await m(r.content,a)}catch(e){t="[Mensaje cifrado]"}}j(a=>{let i=a[g.id]||[];return i.some(e=>e.id===r.id)?a:{...a,[g.id]:[...i,{id:r.id,sender:r.sender_id===e.user.id?"Yo":g.name,text:t,time:new Date(r.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),isEncrypted:r.is_encrypted}]}})}}).subscribe();return()=>{l.supabase.removeChannel(t)}},[g,e?.user?.id]);let I=async t=>{if(t.preventDefault(),!v.trim()||!g||!e?.user?.id)return;N("");let r=v,a=!1;if(C&&A[g.id])try{r=await x(v,A[g.id]),a=!0}catch(e){console.warn("Encryption failed:",e)}let i=Date.now();j(e=>({...e,[g.id]:[...e[g.id]||[],{id:i,sender:"Yo",text:v,time:"Ahora",isEncrypted:a}]}));let{error:s}=await l.supabase.from("messages").insert({sender_id:e.user.id,receiver_id:g.id,content:r,is_encrypted:a});s&&(console.error("Send error:",s),alert("Error al enviar. Intenta de nuevo."))};return d?(0,t.jsxs)("div",{className:"h-screen bg-black flex flex-col overflow-hidden",children:[(0,t.jsx)(a.default,{}),(0,t.jsx)("main",{className:"flex-1 flex overflow-hidden pt-20 md:pt-24",children:(0,t.jsxs)("div",{className:"flex-1 flex max-w-[1600px] mx-auto w-full border-x border-white/5 bg-zinc-900/50",children:[(0,t.jsxs)("div",{className:`${"chat"===f?"hidden md:flex":"flex"} w-full md:w-[380px] flex-col border-r border-white/5 bg-zinc-900/80`,children:[(0,t.jsxs)("div",{className:"p-6 border-b border-white/5",children:[(0,t.jsx)("h2",{className:"text-2xl font-black text-white uppercase tracking-tighter italic mb-4",children:"Mis Amigos"}),(0,t.jsx)("div",{className:"relative",children:(0,t.jsx)("input",{type:"text",placeholder:"Buscar chat...",className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-3 text-xs outline-none focus:ring-2 ring-blue-500/20 text-white placeholder:text-zinc-600"})})]}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:D.length>0?D.map(e=>(0,t.jsxs)("button",{onClick:()=>{w(e),b("chat")},className:`w-full p-4 flex items-center gap-4 transition-all border-b border-white/[0.02] ${g?.id===e.id?"bg-blue-600/10 border-l-4 border-l-blue-600":"hover:bg-white/[0.03]"}`,children:[(0,t.jsxs)("div",{className:"w-14 h-14 rounded-full bg-zinc-800 flex items-center justify-center text-2xl relative shrink-0 overflow-hidden border border-white/5",children:[e.avatar?(0,t.jsx)("img",{src:e.avatar,className:"w-full h-full object-cover"}):"ðŸ‘¤",e.online&&(0,t.jsx)("span",{className:"absolute bottom-0.5 right-0.5 w-3.5 h-3.5 bg-green-500 rounded-full border-2 border-zinc-900"})]}),(0,t.jsxs)("div",{className:"text-left flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-0.5",children:[(0,t.jsxs)("p",{className:"font-bold text-white truncate text-sm",children:["@",e.name]}),(0,t.jsx)("span",{className:"text-[9px] text-zinc-500 font-black uppercase tracking-widest",children:"Ahora"})]}),(0,t.jsx)("p",{className:"text-xs truncate text-zinc-500 font-medium italic",children:"Empieza a hablar..."})]})]},e.id)):(0,t.jsxs)("div",{className:"p-8 text-center space-y-4",children:[(0,t.jsx)("p",{className:"text-zinc-500 text-xs font-bold uppercase tracking-widest leading-relaxed",children:"AÃºn no tienes amigos agregados para chatear."}),(0,t.jsx)("a",{href:"/community",className:"text-blue-500 text-[10px] font-black uppercase tracking-widest hover:underline",children:"Buscar Amigos â†’"})]})})]}),(0,t.jsx)("div",{className:`${"chat"===f?"flex":"hidden md:flex"} flex-1 flex-col relative`,children:g?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"p-4 md:p-6 bg-zinc-900/90 backdrop-blur-md border-b border-white/5 flex items-center justify-between z-10",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("button",{onClick:()=>b("list"),className:"md:hidden p-2 text-zinc-400",children:(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:(0,t.jsx)("path",{d:"m15 18-6-6 6-6"})})}),(0,t.jsx)("div",{className:"w-12 h-12 rounded-full bg-zinc-800 border border-white/10 flex items-center justify-center text-xl overflow-hidden shadow-2xl relative",children:g.avatar?(0,t.jsx)("img",{src:g.avatar,className:"w-full h-full object-cover"}):"ðŸ‘¤"}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"font-black text-white uppercase tracking-tighter italic",children:["@",g.name]}),(0,t.jsx)("span",{className:"text-[10px] text-green-500 font-black uppercase tracking-[0.2em]",children:"En LÃ­nea"})]})]}),(0,t.jsx)("div",{className:"flex gap-3",children:(0,t.jsx)("button",{className:"w-10 h-10 rounded-xl bg-white/5 flex items-center justify-center text-zinc-400 hover:bg-white/10 transition-colors",children:(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:(0,t.jsx)("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l2.27-2.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})})})})]}),(0,t.jsx)("div",{ref:k,className:"flex-1 p-6 md:p-10 overflow-y-auto space-y-6 custom-scrollbar bg-[url('https://www.transparenttextures.com/patterns/dark-matter.png')] bg-fixed",children:P?(0,t.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,t.jsx)("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):(y[g.id]||[]).map(e=>(0,t.jsxs)(s.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`flex flex-col ${"Yo"===e.sender?"items-end":"items-start"}`,children:[(0,t.jsxs)("div",{className:`max-w-[85%] md:max-w-[70%] px-5 py-3 rounded-2xl text-sm font-medium shadow-2xl relative ${"Yo"===e.sender?"bg-blue-600 text-white rounded-tr-none":"bg-zinc-800 text-white rounded-tl-none border border-white/5"}`,children:[e.text,e.isEncrypted&&(0,t.jsx)("span",{className:"absolute -bottom-1 -right-1 text-[8px] opacity-30",children:"ðŸ”’"})]}),(0,t.jsx)("span",{className:"text-[9px] font-black text-zinc-600 mt-2 uppercase tracking-widest",children:e.time})]},e.id))}),(0,t.jsx)("div",{className:"p-4 md:p-8 bg-zinc-900 border-t border-white/5",children:(0,t.jsxs)("form",{onSubmit:I,className:"flex gap-4 max-w-4xl mx-auto",children:[(0,t.jsx)("input",{type:"text",value:v,onChange:e=>N(e.target.value),placeholder:"Escribe un mensaje aquÃ­...",className:"flex-1 bg-black border border-white/10 rounded-2xl px-6 py-4 text-sm outline-none focus:ring-2 ring-blue-500/30 text-white placeholder:text-zinc-600 font-medium"}),(0,t.jsx)("button",{type:"submit",disabled:!v.trim(),className:"bg-blue-600 text-white w-14 h-14 rounded-2xl flex items-center justify-center hover:bg-blue-700 transition-all shadow-xl shadow-blue-500/20 disabled:grayscale disabled:opacity-50 active:scale-90",children:(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("path",{d:"m22 2-7 20-4-9-9-4Z"}),(0,t.jsx)("path",{d:"M22 2 11 13"})]})})]})})]}):(0,t.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center p-12 text-center bg-black/40",children:[(0,t.jsx)(s.motion.div,{animate:{scale:[1,1.1,1]},transition:{repeat:1/0,duration:3},className:"text-[120px] mb-8 grayscale opacity-20",children:"ðŸ’¬"}),(0,t.jsx)("h3",{className:"text-3xl font-black text-white uppercase tracking-tighter italic",children:"Selecciona un Chat"}),(0,t.jsx)("p",{className:"text-zinc-500 mt-4 max-w-xs font-medium italic",children:"Toca el nombre de un amigo a la izquierda para empezar a parchar."})]})})]})}),(0,t.jsx)(i.default,{})]}):(0,t.jsxs)("div",{className:"min-h-screen bg-black flex flex-col items-center justify-center p-6 text-center",children:[(0,t.jsx)(a.default,{}),(0,t.jsxs)(s.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6 max-w-sm",children:[(0,t.jsx)("span",{className:"text-8xl block",children:"ðŸ”’"}),(0,t.jsx)("h2",{className:"text-3xl font-black text-white uppercase italic tracking-tighter",children:"Inicia SesiÃ³n"}),(0,t.jsx)("p",{className:"text-zinc-500 font-medium",children:"Debes estar logueado para parchar con tus amigos en el chat privado."}),(0,t.jsx)("a",{href:"/profile",className:"block w-full py-4 bg-blue-600 text-white rounded-2xl font-black uppercase tracking-widest text-[10px] shadow-xl shadow-blue-500/20 active:scale-95 transition-all",children:"Ir al Perfil"})]}),(0,t.jsx)(i.default,{})]})}e.i(33351),e.i(98739),e.s(["default",()=>p],85916)}]);