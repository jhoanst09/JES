{"version":3,"sources":["../../../../app/chat/page.js","../../../../src/services/crypto.js"],"sourcesContent":["'use client';\r\nimport { useState, useEffect, useRef } from 'react';\r\nimport Header from '@/src/components/Header';\r\nimport MobileTabBar from '@/src/components/MobileTabBar';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { useSearchParams } from 'next/navigation';\r\nimport { supabase } from '@/src/services/supabase';\r\nimport { useWishlist } from '@/src/context/WishlistContext';\r\nimport { chatWithAI } from '@/src/services/ai';\r\nimport { getProducts } from '@/src/services/shopify';\r\nimport {\r\n    generateConversationKey,\r\n    encryptMessage,\r\n    decryptMessage\r\n} from '@/src/services/crypto';\r\n\r\nexport default function ChatPage() {\r\n    const { session, friends, isLoggedIn, loading: authLoading } = useWishlist();\r\n    const searchParams = useSearchParams();\r\n    const userId = searchParams.get('user');\r\n    const [view, setView] = useState('list'); // 'list' | 'chat'\r\n    const [activeChat, setActiveChat] = useState(null);\r\n    const [messages, setMessages] = useState({});\r\n    const [input, setInput] = useState('');\r\n    const [onlineUsers, setOnlineUsers] = useState([]);\r\n    const scrollRef = useRef(null);\r\n    const [encryptionKeys, setEncryptionKeys] = useState({});\r\n    const [encryptionEnabled, setEncryptionEnabled] = useState(true);\r\n    const [loadingMessages, setLoadingMessages] = useState(false);\r\n\r\n    // Map friends to chat format - REMOVED JARVIS AND FAKES\r\n    const chatList = friends.map(f => ({\r\n        id: f.id,\r\n        name: f.name || f.email?.split('@')[0] || 'Amigo',\r\n        avatar: f.avatar_url,\r\n        lastMsg: '...',\r\n        type: 'friend',\r\n        online: onlineUsers.includes(f.id)\r\n    }));\r\n\r\n    const [filteredChats, setFilteredChats] = useState(chatList);\r\n\r\n    useEffect(() => {\r\n        setFilteredChats(chatList);\r\n    }, [friends, onlineUsers]);\r\n\r\n    // Scroll to bottom on new messages\r\n    useEffect(() => {\r\n        if (scrollRef.current) {\r\n            scrollRef.current.scrollTop = scrollRef.current.scrollHeight;\r\n        }\r\n    }, [messages, activeChat]);\r\n\r\n    useEffect(() => {\r\n        async function loadTargetUser() {\r\n            if (!userId || authLoading) return;\r\n\r\n            const existing = chatList.find(c => c.id === userId);\r\n            if (existing) {\r\n                setActiveChat(existing);\r\n                setView('chat');\r\n                return;\r\n            }\r\n\r\n            const { data: profile } = await supabase\r\n                .from('profiles')\r\n                .select('*')\r\n                .eq('id', userId)\r\n                .single();\r\n\r\n            if (profile) {\r\n                const newChat = {\r\n                    id: profile.id,\r\n                    name: profile.name,\r\n                    avatar: profile.avatar_url || 'ðŸ‘¤',\r\n                    lastMsg: 'Â¡Parchamos!',\r\n                    type: 'friend',\r\n                    online: true\r\n                };\r\n                setFilteredChats(prev => [newChat, ...prev]);\r\n                setActiveChat(newChat);\r\n                setView('chat');\r\n            }\r\n        }\r\n        loadTargetUser();\r\n    }, [userId, authLoading]);\r\n\r\n    // Persistence Fix: Load messages when session or activeChat changes\r\n    useEffect(() => {\r\n        if (!activeChat || !session?.user?.id) return;\r\n\r\n        async function initEncryptionAndFetchMessages() {\r\n            setLoadingMessages(true);\r\n            try {\r\n                // Initialize encryption keys\r\n                let convKey = encryptionKeys[activeChat.id];\r\n                if (!convKey) {\r\n                    convKey = await generateConversationKey(session.user.id, activeChat.id);\r\n                    setEncryptionKeys(prev => ({ ...prev, [activeChat.id]: convKey }));\r\n                }\r\n\r\n                // Fetch real messages from DB\r\n                const { data, error } = await supabase\r\n                    .from('messages')\r\n                    .select('*')\r\n                    .or(`and(sender_id.eq.${session.user.id},receiver_id.eq.${activeChat.id}),and(sender_id.eq.${activeChat.id},receiver_id.eq.${session.user.id})`)\r\n                    .order('created_at', { ascending: true });\r\n\r\n                if (error) throw error;\r\n\r\n                if (data) {\r\n                    const decryptedMessages = await Promise.all(data.map(async (m) => {\r\n                        let text = m.content;\r\n                        if (m.is_encrypted && convKey) {\r\n                            try {\r\n                                text = await decryptMessage(m.content, convKey);\r\n                            } catch (e) {\r\n                                text = '[Error al descifrar]';\r\n                            }\r\n                        }\r\n                        return {\r\n                            id: m.id,\r\n                            sender: m.sender_id === session.user.id ? 'Yo' : activeChat.name,\r\n                            text,\r\n                            time: new Date(m.created_at).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),\r\n                            isEncrypted: m.is_encrypted\r\n                        };\r\n                    }));\r\n\r\n                    setMessages(prev => ({ ...prev, [activeChat.id]: decryptedMessages }));\r\n                }\r\n            } catch (err) {\r\n                console.error('Error in chat initialization:', err);\r\n            } finally {\r\n                setLoadingMessages(false);\r\n            }\r\n        }\r\n\r\n        initEncryptionAndFetchMessages();\r\n\r\n        // Real-time listener\r\n        const channel = supabase\r\n            .channel(`chat_${activeChat.id}`)\r\n            .on('postgres_changes', {\r\n                event: 'INSERT',\r\n                schema: 'public',\r\n                table: 'messages'\r\n            }, async (payload) => {\r\n                const newM = payload.new;\r\n                if ((newM.sender_id === session.user.id && newM.receiver_id === activeChat.id) ||\r\n                    (newM.sender_id === activeChat.id && newM.receiver_id === session.user.id)) {\r\n\r\n                    let text = newM.content;\r\n                    if (newM.is_encrypted) {\r\n                        const convKey = await generateConversationKey(session.user.id, activeChat.id);\r\n                        try {\r\n                            text = await decryptMessage(newM.content, convKey);\r\n                        } catch (e) { text = '[Mensaje cifrado]'; }\r\n                    }\r\n\r\n                    setMessages(prev => {\r\n                        const current = prev[activeChat.id] || [];\r\n                        if (current.some(msg => msg.id === newM.id)) return prev;\r\n                        return {\r\n                            ...prev,\r\n                            [activeChat.id]: [...current, {\r\n                                id: newM.id,\r\n                                sender: newM.sender_id === session.user.id ? 'Yo' : activeChat.name,\r\n                                text,\r\n                                time: new Date(newM.created_at).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),\r\n                                isEncrypted: newM.is_encrypted\r\n                            }]\r\n                        };\r\n                    });\r\n                }\r\n            })\r\n            .subscribe();\r\n\r\n        return () => { supabase.removeChannel(channel); };\r\n    }, [activeChat, session?.user?.id]);\r\n\r\n    const handleSend = async (e) => {\r\n        e.preventDefault();\r\n        if (!input.trim() || !activeChat || !session?.user?.id) return;\r\n\r\n        const text = input.trim();\r\n        setInput('');\r\n\r\n        let contentToSend = text;\r\n        let isEncrypted = false;\r\n\r\n        // Try encryption but fall back to unencrypted if it fails\r\n        if (encryptionEnabled && encryptionKeys[activeChat.id]) {\r\n            try {\r\n                contentToSend = await encryptMessage(text, encryptionKeys[activeChat.id]);\r\n                isEncrypted = true;\r\n            } catch (err) {\r\n                console.warn('Encryption failed, sending unencrypted:', err);\r\n                contentToSend = text;\r\n                isEncrypted = false;\r\n            }\r\n        }\r\n\r\n        // Optimistic update\r\n        const tempId = Date.now();\r\n        setMessages(prev => ({\r\n            ...prev,\r\n            [activeChat.id]: [...(prev[activeChat.id] || []), {\r\n                id: tempId,\r\n                sender: 'Yo',\r\n                text: text,\r\n                time: 'Ahora',\r\n                isEncrypted\r\n            }]\r\n        }));\r\n\r\n        try {\r\n            const { error } = await supabase\r\n                .from('messages')\r\n                .insert({\r\n                    sender_id: session.user.id,\r\n                    receiver_id: activeChat.id,\r\n                    content: contentToSend,\r\n                    is_encrypted: isEncrypted\r\n                });\r\n\r\n            if (error) {\r\n                console.error('Send error:', error);\r\n                // Remove optimistic message on error\r\n                setMessages(prev => ({\r\n                    ...prev,\r\n                    [activeChat.id]: (prev[activeChat.id] || []).filter(m => m.id !== tempId)\r\n                }));\r\n                alert('Error al enviar mensaje. Verifica tu conexiÃ³n.');\r\n            }\r\n        } catch (err) {\r\n            console.error('Network error:', err);\r\n            setMessages(prev => ({\r\n                ...prev,\r\n                [activeChat.id]: (prev[activeChat.id] || []).filter(m => m.id !== tempId)\r\n            }));\r\n            alert('Error de red. Intenta de nuevo.');\r\n        }\r\n    };\r\n\r\n\r\n    if (!isLoggedIn) {\r\n        return (\r\n            <div className=\"min-h-screen bg-black flex flex-col items-center justify-center p-6 text-center\">\r\n                <Header />\r\n                <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className=\"space-y-6 max-w-sm\">\r\n                    <span className=\"text-8xl block\">ðŸ”’</span>\r\n                    <h2 className=\"text-3xl font-black text-white uppercase italic tracking-tighter\">Inicia SesiÃ³n</h2>\r\n                    <p className=\"text-zinc-500 font-medium\">Debes estar logueado para parchar con tus amigos en el chat privado.</p>\r\n                    <a href=\"/profile\" className=\"block w-full py-4 bg-blue-600 text-white rounded-2xl font-black uppercase tracking-widest text-[10px] shadow-xl shadow-blue-500/20 active:scale-95 transition-all\">Ir al Perfil</a>\r\n                </motion.div>\r\n                <MobileTabBar />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"h-screen bg-black flex flex-col overflow-hidden\">\r\n            <Header />\r\n\r\n            <main className=\"flex-1 flex overflow-hidden pt-20 md:pt-24\">\r\n                <div className=\"flex-1 flex max-w-[1600px] mx-auto w-full border-x border-white/5 bg-zinc-900/50\">\r\n\r\n                    {/* Sidebar: Chats List */}\r\n                    <div className={`${view === 'chat' ? 'hidden md:flex' : 'flex'} w-full md:w-[380px] flex-col border-r border-white/5 bg-zinc-900/80`}>\r\n                        <div className=\"p-6 border-b border-white/5\">\r\n                            <h2 className=\"text-2xl font-black text-white uppercase tracking-tighter italic mb-4\">Mis Amigos</h2>\r\n                            <div className=\"relative\">\r\n                                <input\r\n                                    type=\"text\"\r\n                                    placeholder=\"Buscar chat...\"\r\n                                    className=\"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-3 text-xs outline-none focus:ring-2 ring-blue-500/20 text-white placeholder:text-zinc-600\"\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"flex-1 overflow-y-auto custom-scrollbar\">\r\n                            {filteredChats.length > 0 ? (\r\n                                filteredChats.map(chat => (\r\n                                    <button\r\n                                        key={chat.id}\r\n                                        onClick={() => { setActiveChat(chat); setView('chat'); }}\r\n                                        className={`w-full p-4 flex items-center gap-4 transition-all border-b border-white/[0.02] ${activeChat?.id === chat.id ? 'bg-blue-600/10 border-l-4 border-l-blue-600' : 'hover:bg-white/[0.03]'}`}\r\n                                    >\r\n                                        <div className=\"w-14 h-14 rounded-full bg-zinc-800 flex items-center justify-center text-2xl relative shrink-0 overflow-hidden border border-white/5\">\r\n                                            {chat.avatar ? <img src={chat.avatar} className=\"w-full h-full object-cover\" /> : 'ðŸ‘¤'}\r\n                                            {chat.online && <span className=\"absolute bottom-0.5 right-0.5 w-3.5 h-3.5 bg-green-500 rounded-full border-2 border-zinc-900\" />}\r\n                                        </div>\r\n                                        <div className=\"text-left flex-1 min-w-0\">\r\n                                            <div className=\"flex justify-between items-center mb-0.5\">\r\n                                                <p className=\"font-bold text-white truncate text-sm\">@{chat.name}</p>\r\n                                                <span className=\"text-[9px] text-zinc-500 font-black uppercase tracking-widest\">Ahora</span>\r\n                                            </div>\r\n                                            <p className=\"text-xs truncate text-zinc-500 font-medium italic\">Empieza a hablar...</p>\r\n                                        </div>\r\n                                    </button>\r\n                                ))\r\n                            ) : (\r\n                                <div className=\"p-8 text-center space-y-4\">\r\n                                    <p className=\"text-zinc-500 text-xs font-bold uppercase tracking-widest leading-relaxed\">AÃºn no tienes amigos agregados para chatear.</p>\r\n                                    <a href=\"/community\" className=\"text-blue-500 text-[10px] font-black uppercase tracking-widest hover:underline\">Buscar Amigos â†’</a>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Main Chat Area */}\r\n                    <div className={`${view === 'chat' ? 'flex' : 'hidden md:flex'} flex-1 flex-col relative`}>\r\n                        {activeChat ? (\r\n                            <>\r\n                                {/* Header del Chat */}\r\n                                <div className=\"p-4 md:p-6 bg-zinc-900/90 backdrop-blur-md border-b border-white/5 flex items-center justify-between z-10\">\r\n                                    <div className=\"flex items-center gap-4\">\r\n                                        <button onClick={() => setView('list')} className=\"md:hidden p-2 text-zinc-400\">\r\n                                            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"m15 18-6-6 6-6\" /></svg>\r\n                                        </button>\r\n                                        <div className=\"w-12 h-12 rounded-full bg-zinc-800 border border-white/10 flex items-center justify-center text-xl overflow-hidden shadow-2xl relative\">\r\n                                            {activeChat.avatar ? <img src={activeChat.avatar} className=\"w-full h-full object-cover\" /> : 'ðŸ‘¤'}\r\n                                        </div>\r\n                                        <div>\r\n                                            <h3 className=\"font-black text-white uppercase tracking-tighter italic\">@{activeChat.name}</h3>\r\n                                            <span className=\"text-[10px] text-green-500 font-black uppercase tracking-[0.2em]\">En LÃ­nea</span>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"flex gap-3\">\r\n                                        <button className=\"w-10 h-10 rounded-xl bg-white/5 flex items-center justify-center text-zinc-400 hover:bg-white/10 transition-colors\">\r\n                                            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l2.27-2.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z\" /></svg>\r\n                                        </button>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Area de Mensajes con Scroll Independiente */}\r\n                                <div\r\n                                    ref={scrollRef}\r\n                                    className=\"flex-1 p-6 md:p-10 overflow-y-auto space-y-6 custom-scrollbar bg-[url('https://www.transparenttextures.com/patterns/dark-matter.png')] bg-fixed\"\r\n                                >\r\n                                    {loadingMessages ? (\r\n                                        <div className=\"flex justify-center items-center h-full\">\r\n                                            <div className=\"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin\" />\r\n                                        </div>\r\n                                    ) : (messages[activeChat.id] || []).map((msg) => (\r\n                                        <motion.div\r\n                                            key={msg.id}\r\n                                            initial={{ opacity: 0, y: 10 }}\r\n                                            animate={{ opacity: 1, y: 0 }}\r\n                                            className={`flex flex-col ${msg.sender === 'Yo' ? 'items-end' : 'items-start'}`}\r\n                                        >\r\n                                            <div className={`max-w-[85%] md:max-w-[70%] px-5 py-3 rounded-2xl text-sm font-medium shadow-2xl relative ${msg.sender === 'Yo' ? 'bg-blue-600 text-white rounded-tr-none' : 'bg-zinc-800 text-white rounded-tl-none border border-white/5'}`}>\r\n                                                {msg.text}\r\n                                                {msg.isEncrypted && <span className=\"absolute -bottom-1 -right-1 text-[8px] opacity-30\">ðŸ”’</span>}\r\n                                            </div>\r\n                                            <span className=\"text-[9px] font-black text-zinc-600 mt-2 uppercase tracking-widest\">{msg.time}</span>\r\n                                        </motion.div>\r\n                                    ))}\r\n                                </div>\r\n\r\n                                {/* Footer fijo del Chat (Input) */}\r\n                                <div className=\"p-4 md:p-8 bg-zinc-900 border-t border-white/5\">\r\n                                    <form onSubmit={handleSend} className=\"flex gap-4 max-w-4xl mx-auto\">\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            value={input}\r\n                                            onChange={(e) => setInput(e.target.value)}\r\n                                            placeholder=\"Escribe un mensaje aquÃ­...\"\r\n                                            className=\"flex-1 bg-black border border-white/10 rounded-2xl px-6 py-4 text-sm outline-none focus:ring-2 ring-blue-500/30 text-white placeholder:text-zinc-600 font-medium\"\r\n                                        />\r\n                                        <button\r\n                                            type=\"submit\"\r\n                                            disabled={!input.trim()}\r\n                                            className=\"bg-blue-600 text-white w-14 h-14 rounded-2xl flex items-center justify-center hover:bg-blue-700 transition-all shadow-xl shadow-blue-500/20 disabled:grayscale disabled:opacity-50 active:scale-90\"\r\n                                        >\r\n                                            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"3\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"m22 2-7 20-4-9-9-4Z\" /><path d=\"M22 2 11 13\" /></svg>\r\n                                        </button>\r\n                                    </form>\r\n                                </div>\r\n                            </>\r\n                        ) : (\r\n                            <div className=\"flex-1 flex flex-col items-center justify-center p-12 text-center bg-black/40\">\r\n                                <motion.div animate={{ scale: [1, 1.1, 1] }} transition={{ repeat: Infinity, duration: 3 }} className=\"text-[120px] mb-8 grayscale opacity-20\">ðŸ’¬</motion.div>\r\n                                <h3 className=\"text-3xl font-black text-white uppercase tracking-tighter italic\">Selecciona un Chat</h3>\r\n                                <p className=\"text-zinc-500 mt-4 max-w-xs font-medium italic\">Toca el nombre de un amigo a la izquierda para empezar a parchar.</p>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </main>\r\n        </div>\r\n    );\r\n}\r\n","/**\r\n * JES Store - End-to-End Encryption Service\r\n * Implements double-layer AES-256-GCM encryption using Web Crypto API\r\n * \r\n * Layer 1: User-derived key (from password/user ID)\r\n * Layer 2: Session key (unique per conversation)\r\n */\r\n\r\n// Generate a random key for session encryption\r\nexport async function generateSessionKey() {\r\n    const key = await crypto.subtle.generateKey(\r\n        { name: 'AES-GCM', length: 256 },\r\n        true,\r\n        ['encrypt', 'decrypt']\r\n    );\r\n    return key;\r\n}\r\n\r\n// Export key to storable format\r\nexport async function exportKey(key) {\r\n    const exported = await crypto.subtle.exportKey('raw', key);\r\n    return btoa(String.fromCharCode(...new Uint8Array(exported)));\r\n}\r\n\r\n// Import key from stored format\r\nexport async function importKey(keyString) {\r\n    const keyData = Uint8Array.from(atob(keyString), c => c.charCodeAt(0));\r\n    return await crypto.subtle.importKey(\r\n        'raw',\r\n        keyData,\r\n        { name: 'AES-GCM', length: 256 },\r\n        true,\r\n        ['encrypt', 'decrypt']\r\n    );\r\n}\r\n\r\n// Derive a key from user ID (for Layer 1)\r\nexport async function deriveUserKey(userId, salt = 'jes-store-salt-v1') {\r\n    const encoder = new TextEncoder();\r\n    const keyMaterial = await crypto.subtle.importKey(\r\n        'raw',\r\n        encoder.encode(userId),\r\n        'PBKDF2',\r\n        false,\r\n        ['deriveBits', 'deriveKey']\r\n    );\r\n\r\n    return await crypto.subtle.deriveKey(\r\n        {\r\n            name: 'PBKDF2',\r\n            salt: encoder.encode(salt),\r\n            iterations: 100000,\r\n            hash: 'SHA-256'\r\n        },\r\n        keyMaterial,\r\n        { name: 'AES-GCM', length: 256 },\r\n        true,\r\n        ['encrypt', 'decrypt']\r\n    );\r\n}\r\n\r\n// Encrypt with a single layer\r\nasync function encryptLayer(plaintext, key) {\r\n    const encoder = new TextEncoder();\r\n    const iv = crypto.getRandomValues(new Uint8Array(12));\r\n\r\n    const encrypted = await crypto.subtle.encrypt(\r\n        { name: 'AES-GCM', iv },\r\n        key,\r\n        encoder.encode(plaintext)\r\n    );\r\n\r\n    // Combine IV + ciphertext\r\n    const combined = new Uint8Array(iv.length + encrypted.byteLength);\r\n    combined.set(iv);\r\n    combined.set(new Uint8Array(encrypted), iv.length);\r\n\r\n    return btoa(String.fromCharCode(...combined));\r\n}\r\n\r\n// Decrypt a single layer\r\nasync function decryptLayer(ciphertext, key) {\r\n    const combined = Uint8Array.from(atob(ciphertext), c => c.charCodeAt(0));\r\n    const iv = combined.slice(0, 12);\r\n    const data = combined.slice(12);\r\n\r\n    const decrypted = await crypto.subtle.decrypt(\r\n        { name: 'AES-GCM', iv },\r\n        key,\r\n        data\r\n    );\r\n\r\n    return new TextDecoder().decode(decrypted);\r\n}\r\n\r\n/**\r\n * Encrypt a message using the conversation key\r\n * @param {string} message - The plaintext message\r\n * @param {CryptoKey} key - The shared conversation key\r\n * @returns {string} Base64 encoded encrypted message\r\n */\r\nexport async function encryptMessage(message, key) {\r\n    return await encryptLayer(message, key);\r\n}\r\n\r\n/**\r\n * Decrypt a message using the conversation key\r\n * @param {string} encryptedMessage - Base64 encoded encrypted message\r\n * @param {CryptoKey} key - The shared conversation key\r\n * @returns {string} The original plaintext message\r\n */\r\nexport async function decryptMessage(encryptedMessage, key) {\r\n    try {\r\n        return await decryptLayer(encryptedMessage, key);\r\n    } catch (error) {\r\n        console.error('Decryption failed:', error);\r\n        return '[Mensaje cifrado - No se pudo descifrar]';\r\n    }\r\n}\r\n\r\n/**\r\n * Generate a shared conversation key from two user IDs\r\n * This ensures both users can decrypt the same messages\r\n */\r\nexport async function generateConversationKey(userId1, userId2) {\r\n    // Sort IDs to ensure consistency regardless of who sends\r\n    const sortedIds = [userId1, userId2].sort().join(':');\r\n    return await deriveUserKey(sortedIds, 'jes-conversation-key-v1');\r\n}\r\n"],"names":[],"mappings":"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"}