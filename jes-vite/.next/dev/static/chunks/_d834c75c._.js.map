{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vango/OneDrive/Documents/probandoanti/jes-vite/src/services/supabase.js"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || process.env.VITE_SUPABASE_URL;\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || process.env.VITE_SUPABASE_ANON_KEY;\r\n\r\nif (!supabaseUrl || !supabaseAnonKey) {\r\n    console.warn('Supabase credentials missing! Authentication and DB features will be disabled.');\r\n}\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\r\n\r\n/**\r\n * Upsert user profile data\r\n */\r\nexport async function updateProfile(userId, updates) {\r\n    try {\r\n        const { error } = await supabase\r\n            .from('profiles')\r\n            .upsert({\r\n                id: userId,\r\n                ...updates,\r\n                updated_at: new Date().toISOString(),\r\n            });\r\n        if (error) throw error;\r\n        return { success: true };\r\n    } catch (error) {\r\n        console.error('Error updating profile:', error);\r\n        return { error };\r\n    }\r\n}\r\n\r\n/**\r\n * Fetch public profiles for the community page\r\n */\r\nexport async function getPublicProfiles(limit = 20) {\r\n    try {\r\n        const { data, error } = await supabase\r\n            .from('profiles')\r\n            .select('*')\r\n            .limit(limit)\r\n            .order('updated_at', { ascending: false });\r\n\r\n        if (error) throw error;\r\n        return data || [];\r\n    } catch (error) {\r\n        if (error.code === 'PGRST116' || error.message?.includes('not found')) {\r\n            console.warn('Profiles table not found. Please run the SQL setup script.');\r\n        } else {\r\n            console.error('Error fetching public profiles:', error);\r\n        }\r\n        return [];\r\n    }\r\n}\r\n\r\n/**\r\n * Fetch a single profile with its wishlist items (from profiles table)\r\n */\r\nexport async function getProfileWithWishlist(userId) {\r\n    try {\r\n        const { data, error } = await supabase\r\n            .from('profiles')\r\n            .select('*')\r\n            .eq('id', userId)\r\n            .single();\r\n\r\n        if (error) throw error;\r\n        return data;\r\n    } catch (error) {\r\n        console.error('Error fetching profile:', error);\r\n        return null;\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;AAEoB;AAFpB;;AAEA,MAAM,cAAc,gFAAwC,2KAAO,CAAC,GAAG,CAAC,iBAAiB;AACzF,MAAM,kBAAkB,wPAA6C,2KAAO,CAAC,GAAG,CAAC,sBAAsB;AAEvG;;AAIO,MAAM,WAAW,IAAA,iMAAY,EAAC,aAAa;AAK3C,eAAe,cAAc,MAAM,EAAE,OAAO;IAC/C,IAAI;QACA,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SACnB,IAAI,CAAC,YACL,MAAM,CAAC;YACJ,IAAI;YACJ,GAAG,OAAO;YACV,YAAY,IAAI,OAAO,WAAW;QACtC;QACJ,IAAI,OAAO,MAAM;QACjB,OAAO;YAAE,SAAS;QAAK;IAC3B,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO;YAAE;QAAM;IACnB;AACJ;AAKO,eAAe,kBAAkB,QAAQ,EAAE;IAC9C,IAAI;QACA,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SACzB,IAAI,CAAC,YACL,MAAM,CAAC,KACP,KAAK,CAAC,OACN,KAAK,CAAC,cAAc;YAAE,WAAW;QAAM;QAE5C,IAAI,OAAO,MAAM;QACjB,OAAO,QAAQ,EAAE;IACrB,EAAE,OAAO,OAAO;QACZ,IAAI,MAAM,IAAI,KAAK,cAAc,MAAM,OAAO,EAAE,SAAS,cAAc;YACnE,QAAQ,IAAI,CAAC;QACjB,OAAO;YACH,QAAQ,KAAK,CAAC,mCAAmC;QACrD;QACA,OAAO,EAAE;IACb;AACJ;AAKO,eAAe,uBAAuB,MAAM;IAC/C,IAAI;QACA,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SACzB,IAAI,CAAC,YACL,MAAM,CAAC,KACP,EAAE,CAAC,MAAM,QACT,MAAM;QAEX,IAAI,OAAO,MAAM;QACjB,OAAO;IACX,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO;IACX;AACJ"}},
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vango/OneDrive/Documents/probandoanti/jes-vite/src/services/shopify.js"],"sourcesContent":["const domain = process.env.NEXT_PUBLIC_SHOPIFY_STORE_DOMAIN || process.env.VITE_SHOPIFY_STORE_DOMAIN;\r\nconst storefrontAccessToken = process.env.NEXT_PUBLIC_SHOPIFY_STOREFRONT_ACCESS_TOKEN || process.env.VITE_SHOPIFY_STOREFRONT_ACCESS_TOKEN;\r\n\r\nif (!domain || !storefrontAccessToken) {\r\n  console.error('CRITICAL: Shopify environment variables are missing!', {\r\n    domain: domain ? 'Defined' : 'UNDEFINED',\r\n    token: storefrontAccessToken ? 'Defined' : 'UNDEFINED'\r\n  });\r\n}\r\n\r\nasync function shopifyFetch({ query, variables }) {\r\n  if (!domain) return null;\r\n  const endpoint = `https://${domain}/api/2024-01/graphql.json`;\r\n\r\n\r\n  try {\r\n    const response = await fetch(endpoint, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'X-Shopify-Storefront-Access-Token': storefrontAccessToken,\r\n      },\r\n      body: JSON.stringify({ query, variables }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`Shopify API error: ${response.statusText}`);\r\n    }\r\n\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error('âŒ Error fetching from Shopify:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function getProducts(limit = 50) {\r\n  const productsQuery = `\r\n    query getProducts($first: Int) {\r\n      products(first: $first) {\r\n        edges {\r\n          node {\r\n            id\r\n            title\r\n            handle\r\n            description\r\n            productType\r\n            tags\r\n            images(first: 1) {\r\n              edges {\r\n                node {\r\n                  url\r\n                  altText\r\n                }\r\n              }\r\n            }\r\n            priceRange {\r\n              minVariantPrice {\r\n                amount\r\n                currencyCode\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  `;\r\n\r\n  const response = await shopifyFetch({ query: productsQuery, variables: { first: limit } });\r\n\r\n  console.log('ðŸ” Shopify full response:', JSON.stringify(response, null, 2));\r\n\r\n  if (!response || !response.data) {\r\n    console.error('âŒ Shopify response empty or invalid:', response);\r\n    return [];\r\n  }\r\n\r\n  console.log('âœ… Fetched products edges:', response.data.products.edges.length);\r\n  return response.data.products.edges.map(({ node }) => ({\r\n    id: node.id,\r\n    title: node.title,\r\n    handle: node.handle,\r\n    description: node.description,\r\n    type: node.productType,\r\n    tags: node.tags,\r\n    image: node.images.edges[0]?.node.url || null,\r\n    price: `$${parseFloat(node.priceRange.minVariantPrice.amount).toLocaleString()}`,\r\n  }));\r\n}\r\n\r\nexport async function getCollectionProducts(collectionHandle) {\r\n  const collectionQuery = `\r\n    query getCollectionProducts($handle: String!) {\r\n      collection(handle: $handle) {\r\n        products(first: 20) {\r\n          edges {\r\n            node {\r\n              id\r\n              title\r\n              handle\r\n              description\r\n              productType\r\n              tags\r\n              images(first: 1) {\r\n                edges {\r\n                  node {\r\n                    url\r\n                    altText\r\n                  }\r\n                }\r\n              }\r\n              priceRange {\r\n                minVariantPrice {\r\n                  amount\r\n                  currencyCode\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  `;\r\n\r\n  const response = await shopifyFetch({\r\n    query: collectionQuery,\r\n    variables: { handle: collectionHandle }\r\n  });\r\n\r\n  if (!response || !response.data || !response.data.collection) return [];\r\n\r\n  return response.data.collection.products.edges.map(({ node }) => ({\r\n    id: node.id,\r\n    title: node.title,\r\n    handle: node.handle,\r\n    description: node.description,\r\n    type: node.productType,\r\n    tags: node.tags,\r\n    image: node.images.edges[0]?.node.url || null,\r\n    price: `$${parseFloat(node.priceRange.minVariantPrice.amount).toLocaleString()}`,\r\n  }));\r\n}\r\n\r\nexport async function getProductByHandle(handle) {\r\n  const productQuery = `\r\n    query getProductByHandle($handle: String!) {\r\n      product(handle: $handle) {\r\n        id\r\n        title\r\n        handle\r\n        description\r\n        descriptionHtml\r\n        productType\r\n        tags\r\n        images(first: 5) {\r\n          edges {\r\n            node {\r\n              url\r\n              altText\r\n            }\r\n          }\r\n        }\r\n        priceRange {\r\n          minVariantPrice {\r\n            amount\r\n            currencyCode\r\n          }\r\n        }\r\n        variants(first: 10) {\r\n          edges {\r\n            node {\r\n              id\r\n              title\r\n              availableForSale\r\n              price {\r\n                amount\r\n                currencyCode\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  `;\r\n\r\n  const response = await shopifyFetch({\r\n    query: productQuery,\r\n    variables: { handle }\r\n  });\r\n\r\n  if (!response || !response.data || !response.data.product) return null;\r\n\r\n  const product = response.data.product;\r\n\r\n  return {\r\n    id: product.id,\r\n    title: product.title,\r\n    handle: product.handle,\r\n    description: product.description,\r\n    descriptionHtml: product.descriptionHtml,\r\n    type: product.productType,\r\n    tags: product.tags,\r\n    images: product.images.edges.map(edge => edge.node.url),\r\n    price: `$${parseFloat(product.priceRange.minVariantPrice.amount).toLocaleString()}`,\r\n    variants: product.variants.edges.map(edge => edge.node),\r\n  };\r\n}\r\nexport async function getProductsByHandles(handles) {\r\n  if (!handles || handles.length === 0) return [];\r\n\r\n  const queryFilter = handles.map(h => `handle:${h}`).join(' OR ');\r\n\r\n  const productsQuery = `\r\n    query getProducts($query: String!) {\r\n      products(first: 50, query: $query) {\r\n        edges {\r\n          node {\r\n            id\r\n            title\r\n            handle\r\n            description\r\n            productType\r\n            tags\r\n            images(first: 1) {\r\n              edges {\r\n                node {\r\n                  url\r\n                }\r\n              }\r\n            }\r\n            priceRange {\r\n              minVariantPrice {\r\n                amount\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  `;\r\n\r\n  const response = await shopifyFetch({\r\n    query: productsQuery,\r\n    variables: { query: queryFilter }\r\n  });\r\n\r\n  if (!response || !response.data) return [];\r\n\r\n  return response.data.products.edges.map(({ node }) => ({\r\n    id: node.id,\r\n    title: node.title,\r\n    handle: node.handle,\r\n    description: node.description,\r\n    type: node.productType,\r\n    tags: node.tags,\r\n    image: node.images.edges[0]?.node.url || null,\r\n    price: `$${parseFloat(node.priceRange.minVariantPrice.amount).toLocaleString()}`,\r\n  }));\r\n}\r\n\r\nexport async function getRelatedProducts(type, limit = 8) {\r\n  if (!type) {\r\n    const all = await getProducts(limit);\r\n    return all.sort(() => 0.5 - Math.random()).slice(0, limit);\r\n  }\r\n\r\n  const query = `product_type:'${type}'`;\r\n  const productsQuery = `\r\n    query getRelated($first: Int, $query: String) {\r\n      products(first: $first, query: $query) {\r\n        edges {\r\n          node {\r\n            id\r\n            title\r\n            handle\r\n            description\r\n            productType\r\n            tags\r\n            images(first: 1) {\r\n              edges {\r\n                node {\r\n                  url\r\n                }\r\n              }\r\n            }\r\n            priceRange {\r\n              minVariantPrice {\r\n                amount\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  `;\r\n\r\n  const response = await shopifyFetch({\r\n    query: productsQuery,\r\n    variables: { first: limit, query }\r\n  });\r\n\r\n  if (!response?.data?.products?.edges) {\r\n    return await getProducts(limit);\r\n  }\r\n\r\n  return response.data.products.edges.map(({ node }) => ({\r\n    id: node.id,\r\n    title: node.title,\r\n    handle: node.handle,\r\n    description: node.description,\r\n    type: node.productType,\r\n    tags: node.tags,\r\n    image: node.images.edges[0]?.node.url || null,\r\n    price: `$${parseFloat(node.priceRange.minVariantPrice.amount).toLocaleString()}`,\r\n  }));\r\n}\r\n\r\n/**\r\n * Get product variant ID for checkout (needs variantId for cart)\r\n */\r\nexport async function getProductVariantId(handle) {\r\n  const productQuery = `\r\n    query getProductVariant($handle: String!) {\r\n      product(handle: $handle) {\r\n        id\r\n        title\r\n        handle\r\n        variants(first: 1) {\r\n          edges {\r\n            node {\r\n              id\r\n              title\r\n              availableForSale\r\n              price {\r\n                amount\r\n                currencyCode\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  `;\r\n\r\n  const response = await shopifyFetch({\r\n    query: productQuery,\r\n    variables: { handle }\r\n  });\r\n\r\n  if (!response?.data?.product?.variants?.edges?.[0]) return null;\r\n\r\n  const variant = response.data.product.variants.edges[0].node;\r\n  return {\r\n    productId: response.data.product.id,\r\n    variantId: variant.id,\r\n    title: response.data.product.title,\r\n    available: variant.availableForSale,\r\n    price: variant.price\r\n  };\r\n}\r\n\r\n/**\r\n * Create a Shopify cart and get checkout URL\r\n * @param {Array} items - Array of {variantId, quantity} objects\r\n * @returns {Object} - { cartId, checkoutUrl }\r\n */\r\nexport async function createShopifyCheckout(items) {\r\n  if (!items || items.length === 0) {\r\n    console.error('No items provided for checkout');\r\n    return null;\r\n  }\r\n\r\n  const cartCreateMutation = `\r\n    mutation cartCreate($input: CartInput!) {\r\n      cartCreate(input: $input) {\r\n        cart {\r\n          id\r\n          checkoutUrl\r\n          totalQuantity\r\n          cost {\r\n            totalAmount {\r\n              amount\r\n              currencyCode\r\n            }\r\n          }\r\n        }\r\n        userErrors {\r\n          field\r\n          message\r\n        }\r\n      }\r\n    }\r\n  `;\r\n\r\n  const lines = items.map(item => ({\r\n    merchandiseId: item.variantId,\r\n    quantity: item.quantity\r\n  }));\r\n\r\n  const response = await shopifyFetch({\r\n    query: cartCreateMutation,\r\n    variables: {\r\n      input: { lines }\r\n    }\r\n  });\r\n\r\n  if (!response?.data?.cartCreate?.cart) {\r\n    console.error('Failed to create Shopify cart:', response?.data?.cartCreate?.userErrors);\r\n    return null;\r\n  }\r\n\r\n  const cart = response.data.cartCreate.cart;\r\n  return {\r\n    cartId: cart.id,\r\n    checkoutUrl: cart.checkoutUrl,\r\n    totalQuantity: cart.totalQuantity,\r\n    totalAmount: cart.cost.totalAmount\r\n  };\r\n}\r\n\r\n/**\r\n * Create checkout for a single product (used for donations)\r\n * @param {string} handle - Product handle\r\n * @param {number} quantity - Quantity (default 1)\r\n * @returns {string|null} - Checkout URL or null\r\n */\r\nexport async function createProductCheckout(handle, quantity = 1) {\r\n  const variant = await getProductVariantId(handle);\r\n  if (!variant) {\r\n    console.error('Could not find product variant for:', handle);\r\n    return null;\r\n  }\r\n\r\n  const checkout = await createShopifyCheckout([{\r\n    variantId: variant.variantId,\r\n    quantity\r\n  }]);\r\n\r\n  return checkout?.checkoutUrl || null;\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 502, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vango/OneDrive/Documents/probandoanti/jes-vite/src/context/WishlistContext.jsx"],"sourcesContent":["import { createContext, useContext, useState, useEffect, useRef } from 'react';\r\nimport { supabase } from '../services/supabase';\r\nimport { getProductsByHandles } from '../services/shopify';\r\n\r\nconst WishlistContext = createContext();\r\n\r\nexport function WishlistProvider({ children }) {\r\n    const isFetchingRef = useRef(false);\r\n    const [wishlist, setWishlist] = useState([]);\r\n    const [userProfile, setUserProfile] = useState({ name: 'Usuario', avatar: 'ðŸ‘¤', bio: '', avatar_url: null });\r\n    const [isLoggedIn, setIsLoggedIn] = useState(false);\r\n    const [session, setSession] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [socialLoading, setSocialLoading] = useState({}); // { [userId]: boolean }\r\n    const [following, setFollowing] = useState([]);\r\n    const [followRequests, setFollowRequests] = useState([]);\r\n    const [sentFollowRequests, setSentFollowRequests] = useState([]);\r\n    const [orders, setOrders] = useState([]);\r\n    const [friends, setFriends] = useState([]);\r\n\r\n    // Initial Auth listener\r\n    useEffect(() => {\r\n        let isMounted = true;\r\n\r\n        const initAuth = async () => {\r\n            // Safety timeout - increased to 15s for stability\r\n            const loadingTimeout = setTimeout(() => {\r\n                if (isMounted) {\r\n                    console.warn('âš ï¸ Auth loading timeout - forcing completion after 15s');\r\n                    setLoading(false);\r\n                }\r\n            }, 15000);\r\n\r\n            try {\r\n                // UX: Track last visit\r\n                localStorage.setItem('jes_last_visit', new Date().toISOString());\r\n\r\n                const { data: { session: initialSession }, error: sessionError } = await supabase.auth.getSession();\r\n\r\n                if (sessionError) throw sessionError;\r\n                if (!isMounted) return;\r\n\r\n                console.log('ðŸ” Initial session:', initialSession ? 'found' : 'none');\r\n\r\n                setSession(initialSession);\r\n                setIsLoggedIn(!!initialSession);\r\n\r\n                if (initialSession) {\r\n                    await fetchUserData(initialSession.user);\r\n                }\r\n            } catch (err) {\r\n                console.error('Error during initial auth check:', err);\r\n            } finally {\r\n                clearTimeout(loadingTimeout);\r\n                if (isMounted) setLoading(false);\r\n            }\r\n        };\r\n\r\n        initAuth();\r\n\r\n        const { data: { subscription } } = supabase.auth.onAuthStateChange(async (_event, newSession) => {\r\n            if (!isMounted) return;\r\n\r\n            console.log('ðŸ”„ Auth state changed:', newSession ? 'logged in' : 'logged out');\r\n\r\n            setSession(newSession);\r\n            setIsLoggedIn(!!newSession);\r\n\r\n            if (newSession) {\r\n                await fetchUserData(newSession.user);\r\n            } else {\r\n                setWishlist([]);\r\n                setUserProfile({ name: 'Usuario', avatar: 'ðŸ‘¤', bio: '' });\r\n                setLoading(false);\r\n            }\r\n        });\r\n\r\n        return () => {\r\n            isMounted = false;\r\n            subscription.unsubscribe();\r\n        };\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (!isLoggedIn || !session?.user?.id) return;\r\n\r\n        // Real-time listener for friendships\r\n        const channel = supabase\r\n            .channel('realtime:friendships')\r\n            .on('postgres_changes', {\r\n                event: '*',\r\n                schema: 'public',\r\n                table: 'friendships'\r\n            }, async (payload) => {\r\n                console.log('Friendship change detected:', payload);\r\n                const { user_id, friend_id } = payload.new || payload.old || {};\r\n\r\n                // If the user is involved in this friendship change, refresh\r\n                if (user_id === session.user.id || friend_id === session.user.id) {\r\n                    console.log('Relevant friendship change for current user, refreshing...');\r\n                    await fetchUserData(session.user);\r\n                }\r\n            })\r\n            .subscribe();\r\n\r\n        return () => {\r\n            supabase.removeChannel(channel);\r\n        };\r\n    }, [isLoggedIn, session?.user?.id]);\r\n\r\n    async function fetchUserData(user) {\r\n        if (!user || isFetchingRef.current) return;\r\n\r\n        isFetchingRef.current = true;\r\n        // Solo mostrar loading si es la primera carga o no hay perfil\r\n        if (!userProfile?.id || !isLoggedIn) setLoading(true);\r\n\r\n        try {\r\n            // 1. Fetch Profile First\r\n            const { data: pData, error: pError } = await supabase\r\n                .from('profiles')\r\n                .select('*')\r\n                .eq('id', user.id)\r\n                .maybeSingle();\r\n\r\n            if (pError) console.warn('Error fetching profile:', pError);\r\n\r\n            if (pData) {\r\n                setUserProfile({\r\n                    ...pData,\r\n                    id: pData.id, // Explicitly ensure ID is here\r\n                    avatar: pData.avatar_url || 'ðŸŒ´',\r\n                    bio: pData.bio || ''\r\n                });\r\n            } else {\r\n                // ... logic to create profile if it doesn't exist\r\n                const newProfile = {\r\n                    id: user.id,\r\n                    name: user.email?.split('@')[0] || 'Usuario',\r\n                    avatar_url: null,\r\n                    bio: '',\r\n                    updated_at: new Date().toISOString()\r\n                };\r\n                const { data: created, error: iError } = await supabase.from('profiles').insert(newProfile).select().maybeSingle();\r\n                if (iError) console.error('Error creating profile:', iError);\r\n                if (created) {\r\n                    setUserProfile({\r\n                        ...created,\r\n                        id: created.id,\r\n                        avatar: 'ðŸŒ´',\r\n                        bio: ''\r\n                    });\r\n                } else {\r\n                    // Fallback if insert failed but we have a user\r\n                    setUserProfile({\r\n                        id: user.id,\r\n                        name: user.email?.split('@')[0] || 'Usuario',\r\n                        avatar: 'ðŸ‘¤',\r\n                        bio: ''\r\n                    });\r\n                }\r\n            }\r\n\r\n            // 2. Fetch the rest in parallel\r\n            await Promise.allSettled([\r\n                fetchWishlist(user.id),\r\n                fetchFriendships(user.id),\r\n                fetchOrders(user.id)\r\n            ]);\r\n\r\n        } catch (err) {\r\n            console.error('Error hydrating user data:', err);\r\n        } finally {\r\n            setLoading(false);\r\n            isFetchingRef.current = false;\r\n        }\r\n    }\r\n\r\n    async function fetchWishlist(userId) {\r\n        try {\r\n            const { data: items, error: wError } = await supabase\r\n                .from('wishlist_items')\r\n                .select('*')\r\n                .eq('user_id', userId);\r\n\r\n            if (wError) throw wError;\r\n\r\n            if (items && items.length > 0) {\r\n                const handles = [...new Set(items.map(i => i.product_handle))].filter(Boolean);\r\n                try {\r\n                    const products = await getProductsByHandles(handles);\r\n                    const enriched = items.map(dbItem => {\r\n                        const shopifyProduct = products.find(p => p.handle === dbItem.product_handle);\r\n                        return shopifyProduct\r\n                            ? { ...shopifyProduct, isPrivate: dbItem.is_private, db_id: dbItem.id }\r\n                            : { id: `missing-${dbItem.product_handle}`, handle: dbItem.product_handle, title: `Producto no disponible`, price: '---', isPrivate: dbItem.is_private, db_id: dbItem.id };\r\n                    });\r\n                    setWishlist(enriched);\r\n                } catch (err) {\r\n                    console.error('Shopify fetch error:', err);\r\n                }\r\n            } else {\r\n                setWishlist([]);\r\n            }\r\n        } catch (err) {\r\n            if (err.code === 'PGRST116' || err.status === 404) {\r\n                console.warn('Tabla wishlist_items no encontrada.');\r\n            } else {\r\n                console.error('Error fetching wishlist:', err);\r\n            }\r\n        }\r\n    }\r\n\r\n    async function fetchFriendships(userId) {\r\n        try {\r\n            const { data: relationshipData, error: fError } = await supabase\r\n                .from('friendships')\r\n                .select('*')\r\n                .or(`user_id.eq.${userId},friend_id.eq.${userId}`);\r\n\r\n            if (fError) throw fError;\r\n\r\n            if (relationshipData) {\r\n                const accepted = relationshipData.filter(r => r.status === 'accepted');\r\n                const friendIds = accepted.map(f => f.user_id === userId ? f.friend_id : f.user_id);\r\n                setFollowing(friendIds);\r\n\r\n                if (friendIds.length > 0) {\r\n                    const { data: fullFriendProfiles } = await supabase.from('profiles').select('*').in('id', friendIds);\r\n                    if (fullFriendProfiles) setFriends(fullFriendProfiles);\r\n                }\r\n\r\n                const incoming = relationshipData.filter(r => r.friend_id === userId && r.status === 'pending');\r\n                setFollowRequests(incoming);\r\n\r\n                const outgoing = relationshipData.filter(r => r.user_id === userId && r.status === 'pending');\r\n                setSentFollowRequests(outgoing.map(r => r.friend_id));\r\n            }\r\n        } catch (err) {\r\n            console.warn('Error fetching friendships (check if table exists):', err.message);\r\n        }\r\n    }\r\n\r\n    async function fetchOrders(userId) {\r\n        try {\r\n            const { data: oData, error: oError } = await supabase\r\n                .from('orders')\r\n                .select('*')\r\n                .eq('user_id', userId)\r\n                .order('created_at', { ascending: false });\r\n\r\n            if (oError) throw oError;\r\n            if (oData) setOrders(oData);\r\n        } catch (err) {\r\n            console.warn('Error fetching orders (check if table exists):', err.message);\r\n        }\r\n    }\r\n\r\n    const login = async ({ email, password }) => {\r\n        if (password) {\r\n            const { data, error } = await supabase.auth.signInWithPassword({ email, password });\r\n            if (error) throw error;\r\n            return data;\r\n        } else {\r\n            const { data, error } = await supabase.auth.signInWithOtp({ email });\r\n            if (error) throw error;\r\n            return data;\r\n        }\r\n    };\r\n\r\n    const signUp = async ({ email, password }) => {\r\n        const { data, error } = await supabase.auth.signUp({\r\n            email,\r\n            password,\r\n            options: {\r\n                data: {\r\n                    name: email.split('@')[0]\r\n                },\r\n                emailRedirectTo: window.location.origin + '/profile'\r\n            }\r\n        });\r\n\r\n        if (error) {\r\n            if (error.message.includes('already registered')) {\r\n                throw new Error('Este correo ya estÃ¡ registrado. Intenta iniciar sesiÃ³n.');\r\n            }\r\n            throw error;\r\n        }\r\n\r\n        // Manual check for session if email confirmation is disabled/enabled\r\n        if (data.user && !data.session) {\r\n            // This happens when email confirmation is enabled in Supabase\r\n            return { ...data, needsConfirmation: true };\r\n        }\r\n\r\n        return data;\r\n    };\r\n\r\n    const loginWithGoogle = async () => {\r\n        const { error } = await supabase.auth.signInWithOAuth({\r\n            provider: 'google',\r\n            options: {\r\n                redirectTo: window.location.origin + '/profile'\r\n            }\r\n        });\r\n        if (error) throw error;\r\n    };\r\n\r\n    const resetPassword = async (email) => {\r\n        const { error } = await supabase.auth.resetPasswordForEmail(email, {\r\n            redirectTo: window.location.origin + '/profile'\r\n        });\r\n        if (error) throw error;\r\n    };\r\n\r\n    const logout = async () => {\r\n        await supabase.auth.signOut();\r\n    };\r\n\r\n    const addToWishlist = async (product, isPrivate = false) => {\r\n        if (!isLoggedIn) return;\r\n\r\n        // Optimistic UI\r\n        setWishlist(prev => [...prev, { ...product, isPrivate }]);\r\n\r\n        const { error } = await supabase\r\n            .from('wishlist_items')\r\n            .insert({\r\n                user_id: session.user.id,\r\n                product_handle: product.handle,\r\n                is_private: isPrivate\r\n            });\r\n\r\n        if (error) {\r\n            console.error('Error adding to DB:', error);\r\n            alert(`Â¡Erda! No pudimos guardar el deseo: ${error.message}`);\r\n            // Rollback\r\n            setWishlist(prev => prev.filter(p => p.handle !== product.handle));\r\n        }\r\n    };\r\n\r\n    const removeFromWishlist = async (productId) => {\r\n        if (!isLoggedIn) return;\r\n\r\n        console.log('Attempting to remove product:', productId);\r\n        const product = wishlist.find(p => p.id === productId || p.db_id === productId);\r\n        if (!product) {\r\n            console.error('Product not found in local wishlist state');\r\n            return;\r\n        }\r\n\r\n        // Optimistic UI\r\n        setWishlist(prev => prev.filter(p => p.id !== product.id && p.db_id !== product.db_id));\r\n\r\n        const { error } = await supabase\r\n            .from('wishlist_items')\r\n            .delete()\r\n            .eq('user_id', session.user.id)\r\n            .eq('product_handle', product.handle);\r\n\r\n        if (error) {\r\n            console.error('Error removing from DB:', error);\r\n            // Rollback if needed\r\n            fetchUserData(session.user);\r\n        } else {\r\n            console.log('Successfully removed from DB');\r\n        }\r\n    };\r\n\r\n    const sendFollowRequest = async (targetUserId) => {\r\n        if (!isLoggedIn) return;\r\n\r\n        // Check if already following\r\n        if (following.includes(targetUserId)) return;\r\n\r\n        const { error } = await supabase\r\n            .from('friendships')\r\n            .insert({\r\n                user_id: session.user.id,\r\n                friend_id: targetUserId,\r\n                status: 'pending'\r\n            });\r\n\r\n        if (error) {\r\n            console.error('CRITICAL: Error sending friend request:', error);\r\n            alert(`No se pudo enviar la solicitud: ${error.message}`);\r\n        } else {\r\n            console.log('Friend request sent successfully to:', targetUserId);\r\n            setSentFollowRequests(prev => [...prev, targetUserId]);\r\n            alert('Â¡Listo! Solicitud de amistad enviada. âŒ›');\r\n        }\r\n    };\r\n\r\n    const acceptFollowRequest = async (requestId, senderId) => {\r\n        if (!isLoggedIn) return;\r\n\r\n        // Update friendships status to 'accepted'\r\n        const { error: fError } = await supabase\r\n            .from('friendships')\r\n            .update({ status: 'accepted' })\r\n            .eq('id', requestId);\r\n\r\n        if (fError) {\r\n            console.error('Error accepting friend request:', fError);\r\n            alert('Error al aceptar la solicitud.');\r\n            return;\r\n        }\r\n\r\n        // Update local state\r\n        setFollowRequests(prev => prev.filter(r => r.id !== requestId));\r\n        setFollowing(prev => [...prev, senderId]);\r\n        alert('Â¡Solicitud aceptada! Ahora son amigos. âœ“');\r\n    };\r\n\r\n    const rejectFollowRequest = async (requestId) => {\r\n        if (!isLoggedIn) return;\r\n\r\n        await supabase\r\n            .from('friendships')\r\n            .delete()\r\n            .eq('id', requestId);\r\n\r\n        setFollowRequests(prev => prev.filter(r => r.id !== requestId));\r\n        alert('Solicitud rechazada.');\r\n    };\r\n\r\n    const toggleFollow = async (friendId) => {\r\n        if (!isLoggedIn) {\r\n            alert('Â¡Hola! Debes iniciar sesiÃ³n para aÃ±adir amigos. ðŸ’¡');\r\n            return;\r\n        }\r\n        if (!session?.user?.id) return;\r\n\r\n        setSocialLoading(prev => ({ ...prev, [friendId]: true }));\r\n        try {\r\n            const isFollowing = following.includes(friendId);\r\n\r\n            if (isFollowing) {\r\n                // Unfriend\r\n                if (window.confirm('Â¿Quieres eliminar a este amigo?')) {\r\n                    setFollowing(prev => prev.filter(id => id !== friendId));\r\n                    await supabase\r\n                        .from('friendships')\r\n                        .delete()\r\n                        .or(`and(user_id.eq.${session.user.id},friend_id.eq.${friendId}),and(user_id.eq.${friendId},friend_id.eq.${session.user.id})`);\r\n\r\n                    fetchUserData(session.user);\r\n                }\r\n                // Check if there is already a pending request\r\n                const { data: existing, error: selectError } = await supabase\r\n                    .from('friendships')\r\n                    .select('*')\r\n                    .or(`and(user_id.eq.${session.user.id},friend_id.eq.${friendId}),and(user_id.eq.${friendId},friend_id.eq.${session.user.id})`)\r\n                    .maybeSingle();\r\n\r\n                if (selectError) {\r\n                    console.error('Error checking existing friendship:', selectError);\r\n                }\r\n\r\n                if (existing) {\r\n                    if (existing.status === 'pending') {\r\n                        if (existing.user_id === session.user.id) {\r\n                            alert('Ya enviaste una solicitud. Â¡Pronto recibirÃ¡ noticias!');\r\n                        } else {\r\n                            alert('Este usuario ya te enviÃ³ una solicitud. BÃºscala en tu perfil.');\r\n                        }\r\n                    } else if (existing.status === 'accepted') {\r\n                        await fetchUserData(session.user);\r\n                    }\r\n                    return;\r\n                }\r\n\r\n                console.log('Sending new friend request to:', friendId);\r\n                await sendFollowRequest(friendId);\r\n            }\r\n        } catch (err) {\r\n            console.error('Error in toggleFollow:', err);\r\n            alert('Vaya, algo saliÃ³ mal al intentar seguir a este usuario.');\r\n        } finally {\r\n            setSocialLoading(prev => ({ ...prev, [friendId]: false }));\r\n        }\r\n    };\r\n\r\n    const togglePrivacy = async (productId) => {\r\n        if (!isLoggedIn) return;\r\n\r\n        console.log('Toggling privacy for:', productId);\r\n        const product = wishlist.find(p => p.id === productId || p.db_id === productId);\r\n        if (!product) {\r\n            console.error('Product not found for privacy toggle');\r\n            return;\r\n        }\r\n\r\n        const newPrivate = !product.isPrivate;\r\n\r\n        // Optimistic UI\r\n        setWishlist(prev => prev.map(p =>\r\n            p.id === productId ? { ...p, isPrivate: newPrivate } : p\r\n        ));\r\n\r\n        const { error } = await supabase\r\n            .from('wishlist_items')\r\n            .update({ is_private: newPrivate })\r\n            .eq('user_id', session.user.id)\r\n            .eq('product_handle', product.handle);\r\n\r\n        if (error) console.error('Error updating privacy in DB:', error);\r\n    };\r\n\r\n    const toggleWishlist = (product) => {\r\n        if (wishlist.find(p => p.id === product.id)) {\r\n            removeFromWishlist(product.id);\r\n        } else {\r\n            addToWishlist(product);\r\n        }\r\n    };\r\n\r\n    const isInWishlist = (productId) => {\r\n        return !!wishlist.find(p => p.id === productId);\r\n    };\r\n\r\n    const isPrivate = (productId) => {\r\n        return wishlist.find(p => p.id === productId)?.isPrivate || false;\r\n    };\r\n\r\n    const updateProfile = async (updates) => {\r\n        if (!isLoggedIn) return;\r\n\r\n        const { error } = await supabase\r\n            .from('profiles')\r\n            .update(updates)\r\n            .eq('id', session.user.id);\r\n\r\n        if (!error) {\r\n            setUserProfile(prev => ({ ...prev, ...updates }));\r\n        }\r\n    };\r\n\r\n    const placeOrder = async (product) => {\r\n        if (!isLoggedIn) return;\r\n\r\n        const { error } = await supabase\r\n            .from('orders')\r\n            .insert({\r\n                user_id: session.user.id,\r\n                product_handle: product.handle,\r\n                product_title: product.nombre || product.title,\r\n                price: product.precio || product.price,\r\n                status: 'completado',\r\n                created_at: new Date().toISOString()\r\n            });\r\n\r\n        if (!error) {\r\n            // Refresh orders\r\n            const { data: userOrders } = await supabase\r\n                .from('orders')\r\n                .select('*')\r\n                .eq('user_id', session.user.id)\r\n                .order('created_at', { ascending: false });\r\n            if (userOrders) setOrders(userOrders);\r\n        } else {\r\n            console.error('Error placing order:', error);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <WishlistContext.Provider value={{\r\n            wishlist,\r\n            addToWishlist,\r\n            removeFromWishlist,\r\n            toggleWishlist,\r\n            isInWishlist,\r\n            togglePrivacy,\r\n            userProfile,\r\n            updateProfile,\r\n            toggleFollow,\r\n            following,\r\n            friends,\r\n            orders,\r\n            placeOrder,\r\n            isLoggedIn,\r\n            loading,\r\n            socialLoading,\r\n            login,\r\n            signUp,\r\n            loginWithGoogle,\r\n            resetPassword,\r\n            logout,\r\n            followRequests,\r\n            sentFollowRequests,\r\n            sendFollowRequest,\r\n            acceptFollowRequest,\r\n            rejectFollowRequest\r\n        }}>\r\n            {children}\r\n        </WishlistContext.Provider>\r\n    );\r\n}\r\n\r\nexport const useWishlist = () => useContext(WishlistContext);\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1069, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vango/OneDrive/Documents/probandoanti/jes-vite/src/context/CartContext.jsx"],"sourcesContent":["import { createContext, useContext, useState, useEffect } from 'react';\r\nimport { useWishlist } from './WishlistContext';\r\nimport { createShopifyCheckout, getProductVariantId } from '../services/shopify';\r\n\r\nconst CartContext = createContext();\r\n\r\nexport function CartProvider({ children }) {\r\n    const { isLoggedIn } = useWishlist();\r\n    const SHIPPING_COST = 15000; // 15,000 COP\r\n\r\n    const [cart, setCart] = useState(() => {\r\n        const savedCart = localStorage.getItem('jes-cart');\r\n        return savedCart ? JSON.parse(savedCart) : [];\r\n    });\r\n    const [isCartOpen, setIsCartOpen] = useState(false);\r\n    const [isCheckingOut, setIsCheckingOut] = useState(false);\r\n\r\n    useEffect(() => {\r\n        localStorage.setItem('jes-cart', JSON.stringify(cart));\r\n    }, [cart]);\r\n\r\n    const addToCart = async (product, isGift = false) => {\r\n        // If product doesn't have variantId, fetch it\r\n        let variantId = product.variantId;\r\n        if (!variantId && product.handle) {\r\n            const variantData = await getProductVariantId(product.handle);\r\n            variantId = variantData?.variantId || null;\r\n        }\r\n\r\n        const cartId = `${product.handle}${isGift ? '-gift' : ''}`;\r\n\r\n        setCart(prev => {\r\n            const existing = prev.find(item => item.cartId === cartId);\r\n            if (existing) {\r\n                return prev.map(item =>\r\n                    item.cartId === cartId\r\n                        ? { ...item, quantity: item.quantity + 1 }\r\n                        : item\r\n                );\r\n            }\r\n            return [...prev, { ...product, variantId, quantity: 1, isGift, cartId }];\r\n        });\r\n        setIsCartOpen(true);\r\n    };\r\n\r\n    const removeFromCart = (cartId) => {\r\n        setCart(prev => prev.filter(item => item.cartId !== cartId));\r\n    };\r\n\r\n    const updateQuantity = (cartId, delta) => {\r\n        setCart(prev => prev.map(item => {\r\n            if (item.cartId === cartId) {\r\n                const newQty = Math.max(1, item.quantity + delta);\r\n                return { ...item, quantity: newQty };\r\n            }\r\n            return item;\r\n        }));\r\n    };\r\n\r\n    const cartCount = cart.reduce((total, item) => total + item.quantity, 0);\r\n\r\n    const cartSubtotal = cart.reduce((total, item) => {\r\n        // Remove dots (thousand separators) and currency symbols before parsing\r\n        const cleanPrice = item.price.replace(/[$. ]/g, '');\r\n        const price = parseFloat(cleanPrice) || 0;\r\n        return total + (price * item.quantity);\r\n    }, 0);\r\n\r\n    const shippingCost = isLoggedIn ? 0 : (cart.length > 0 ? SHIPPING_COST : 0);\r\n    const cartTotal = cartSubtotal + shippingCost;\r\n\r\n    const clearCart = () => setCart([]);\r\n\r\n    const startCheckout = async () => {\r\n        if (cart.length === 0) return;\r\n\r\n        setIsCheckingOut(true);\r\n\r\n        try {\r\n            // Ensure all items have variantIds\r\n            const itemsWithVariants = await Promise.all(\r\n                cart.map(async (item) => {\r\n                    if (item.variantId) {\r\n                        return { variantId: item.variantId, quantity: item.quantity };\r\n                    }\r\n                    // Fetch variant if missing\r\n                    const variantData = await getProductVariantId(item.handle);\r\n                    return {\r\n                        variantId: variantData?.variantId,\r\n                        quantity: item.quantity\r\n                    };\r\n                })\r\n            );\r\n\r\n            // Filter out items without variants\r\n            const validItems = itemsWithVariants.filter(item => item.variantId);\r\n\r\n            if (validItems.length === 0) {\r\n                alert('No se pudieron procesar los productos. Intenta de nuevo.');\r\n                setIsCheckingOut(false);\r\n                return;\r\n            }\r\n\r\n            const checkout = await createShopifyCheckout(validItems);\r\n\r\n            if (checkout?.checkoutUrl) {\r\n                // Redirect to Shopify checkout\r\n                window.location.href = checkout.checkoutUrl;\r\n            } else {\r\n                alert('Error al crear el checkout. Intenta de nuevo.');\r\n            }\r\n        } catch (error) {\r\n            console.error('Checkout error:', error);\r\n            alert('Error al procesar el pago. Intenta de nuevo.');\r\n        } finally {\r\n            setIsCheckingOut(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <CartContext.Provider value={{\r\n            cart,\r\n            addToCart,\r\n            removeFromCart,\r\n            updateQuantity,\r\n            cartCount,\r\n            cartSubtotal,\r\n            shippingCost,\r\n            cartTotal,\r\n            clearCart,\r\n            isCartOpen,\r\n            setIsCartOpen,\r\n            isLoggedIn,\r\n            startCheckout,\r\n            isCheckingOut\r\n        }}>\r\n            {children}\r\n        </CartContext.Provider>\r\n    );\r\n}\r\n\r\nexport const useCart = () => useContext(CartContext);\r\n\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1242, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vango/OneDrive/Documents/probandoanti/jes-vite/src/context/ThemeContext.jsx"],"sourcesContent":["import { createContext, useContext, useState, useEffect } from 'react';\r\n\r\nconst ThemeContext = createContext();\r\n\r\nexport function ThemeProvider({ children }) {\r\n    const [isLightMode, setIsLightMode] = useState(false);\r\n    const [mounted, setMounted] = useState(false);\r\n\r\n    useEffect(() => {\r\n        const saved = localStorage.getItem('jes-theme');\r\n        if (saved === 'light') {\r\n            setIsLightMode(true);\r\n        }\r\n        setMounted(true);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (!mounted) return;\r\n\r\n        localStorage.setItem('jes-theme', isLightMode ? 'light' : 'dark');\r\n\r\n        if (isLightMode) {\r\n            document.documentElement.classList.add('light-mode');\r\n            document.documentElement.classList.remove('dark');\r\n            document.documentElement.classList.remove('dark-mode');\r\n        } else {\r\n            document.documentElement.classList.add('dark');\r\n            document.documentElement.classList.remove('light-mode');\r\n        }\r\n    }, [isLightMode, mounted]);\r\n\r\n    const toggleTheme = () => setIsLightMode(prev => !prev);\r\n\r\n    return (\r\n        <ThemeContext.Provider value={{ isLightMode, toggleTheme }}>\r\n            {children}\r\n        </ThemeContext.Provider>\r\n    );\r\n}\r\n\r\nexport const useTheme = () => useContext(ThemeContext);\r\n"],"names":[],"mappings":";;;;;;;AAAA;;;;AAEA,MAAM,6BAAe,IAAA,8KAAa;AAE3B,SAAS,cAAc,EAAE,QAAQ,EAAE;;IACtC,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAC;IAC/C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,IAAA,0KAAS;mCAAC;YACN,MAAM,QAAQ,aAAa,OAAO,CAAC;YACnC,IAAI,UAAU,SAAS;gBACnB,eAAe;YACnB;YACA,WAAW;QACf;kCAAG,EAAE;IAEL,IAAA,0KAAS;mCAAC;YACN,IAAI,CAAC,SAAS;YAEd,aAAa,OAAO,CAAC,aAAa,cAAc,UAAU;YAE1D,IAAI,aAAa;gBACb,SAAS,eAAe,CAAC,SAAS,CAAC,GAAG,CAAC;gBACvC,SAAS,eAAe,CAAC,SAAS,CAAC,MAAM,CAAC;gBAC1C,SAAS,eAAe,CAAC,SAAS,CAAC,MAAM,CAAC;YAC9C,OAAO;gBACH,SAAS,eAAe,CAAC,SAAS,CAAC,GAAG,CAAC;gBACvC,SAAS,eAAe,CAAC,SAAS,CAAC,MAAM,CAAC;YAC9C;QACJ;kCAAG;QAAC;QAAa;KAAQ;IAEzB,MAAM,cAAc,IAAM,eAAe,CAAA,OAAQ,CAAC;IAElD,qBACI,6LAAC,aAAa,QAAQ;QAAC,OAAO;YAAE;YAAa;QAAY;kBACpD;;;;;;AAGb;GAlCgB;KAAA;AAoCT,MAAM,WAAW;;IAAM,OAAA,IAAA,2KAAU,EAAC;AAAY;IAAxC"}},
    {"offset": {"line": 1313, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vango/OneDrive/Documents/probandoanti/jes-vite/src/context/TerminalContext.jsx"],"sourcesContent":["import { createContext, useContext, useState } from 'react';\r\n\r\nconst TerminalContext = createContext();\r\n\r\nexport function TerminalProvider({ children }) {\r\n    const [isOpen, setIsOpen] = useState(false);\r\n    const [activeProduct, setActiveProduct] = useState(null);\r\n\r\n    const openTerminal = (product = null) => {\r\n        setActiveProduct(product);\r\n        setIsOpen(true);\r\n    };\r\n\r\n    const closeTerminal = () => {\r\n        setIsOpen(false);\r\n        setActiveProduct(null);\r\n    };\r\n\r\n    return (\r\n        <TerminalContext.Provider value={{ isOpen, openTerminal, closeTerminal, activeProduct }}>\r\n            {children}\r\n        </TerminalContext.Provider>\r\n    );\r\n}\r\n\r\nexport const useTerminal = () => useContext(TerminalContext);\r\n"],"names":[],"mappings":";;;;;;;AAAA;;;;AAEA,MAAM,gCAAkB,IAAA,8KAAa;AAE9B,SAAS,iBAAiB,EAAE,QAAQ,EAAE;;IACzC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAC;IACrC,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAC;IAEnD,MAAM,eAAe,CAAC,UAAU,IAAI;QAChC,iBAAiB;QACjB,UAAU;IACd;IAEA,MAAM,gBAAgB;QAClB,UAAU;QACV,iBAAiB;IACrB;IAEA,qBACI,6LAAC,gBAAgB,QAAQ;QAAC,OAAO;YAAE;YAAQ;YAAc;YAAe;QAAc;kBACjF;;;;;;AAGb;GAnBgB;KAAA;AAqBT,MAAM,cAAc;;IAAM,OAAA,IAAA,2KAAU,EAAC;AAAe;IAA9C"}},
    {"offset": {"line": 1367, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vango/OneDrive/Documents/probandoanti/jes-vite/src/services/ai.js"],"sourcesContent":["const OPENROUTER_MODEL = process.env.NEXT_PUBLIC_OPENROUTER_MODEL || process.env.VITE_OPENROUTER_MODEL || \"google/learnlm-1.5-pro-experimental:free\";\r\n\r\nexport async function chatWithAI(messages, productContext = []) {\r\n    const systemPrompt = `\r\nEres \"JARVIS\" (Just A Rather Very Intelligent System), el asistente virtual de JES Store.\r\n\r\nTU PERSONALIDAD:\r\n- Eres inteligente, eficiente y con un toque de humor sutil como el JARVIS de Iron Man.\r\n- Hablas de forma directa pero amable.\r\n- Puedes bromear ocasionalmente pero siempre siendo Ãºtil.\r\n- No usas emojis excesivos, uno o dos mÃ¡ximo por mensaje.\r\n\r\nTUS CAPACIDADES:\r\n- Recomendar productos de la tienda JES\r\n- Ayudar con el carrito de compras\r\n- Responder preguntas sobre productos, precios y disponibilidad\r\n- Dar consejos sobre tecnologÃ­a, moda y mÃºsica\r\n\r\nCOMANDOS QUE PUEDES EJECUTAR (el sistema los detectarÃ¡):\r\n- Para aÃ±adir al carrito: [ADD_CART:handle_del_producto]\r\n- Para quitar del carrito: [REMOVE_CART:handle_del_producto]\r\n- Para ver un producto: [PRODUCT:handle_del_producto]\r\n- Para buscar productos: [SEARCH:tÃ©rmino_de_bÃºsqueda]\r\n\r\nREGLA IMPORTANTE:\r\n- SOLO recomienda productos que estÃ©n en el CONTEXTO DE PRODUCTOS que te proporciono.\r\n- Si no encuentras un producto en el contexto, di honestamente que no lo tienes.\r\n- Usa los handles exactos del contexto para los comandos.\r\n\r\nCONTEXTO DE PRODUCTOS DISPONIBLES:\r\n${JSON.stringify(productContext.map(p => ({ title: p.title, handle: p.handle, price: p.price, type: p.type })), null, 2)}\r\n`;\r\n\r\n    try {\r\n        const response = await fetch(\"/api/chat\", {\r\n            method: \"POST\",\r\n            headers: {\r\n                \"Content-Type\": \"application/json\",\r\n            },\r\n            body: JSON.stringify({\r\n                model: OPENROUTER_MODEL,\r\n                systemPrompt: systemPrompt,\r\n                messages: messages\r\n            })\r\n        });\r\n\r\n        const data = await response.json();\r\n\r\n        if (data.error) {\r\n            console.error(\"AI Error:\", data.error);\r\n            return `Â¡Vaya! El sistema dice: \"${data.error.message || data.error || 'error desconocido'}\". Por favor verifica la configuraciÃ³n.`;\r\n        }\r\n\r\n        return data.choices?.[0]?.message?.content || \"Lo siento, no pude procesar tu solicitud. Por favor intenta de nuevo.\";\r\n    } catch (error) {\r\n        console.error(\"AI Assistant Error:\", error);\r\n        return \"Error de conexiÃ³n con JARVIS.\";\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAyB;AAAzB,MAAM,mBAAmB,wEAA4C,2KAAO,CAAC,GAAG,CAAC,qBAAqB,IAAI;AAEnG,eAAe,WAAW,QAAQ,EAAE,iBAAiB,EAAE;IAC1D,MAAM,eAAe,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2B1B,EAAE,KAAK,SAAS,CAAC,eAAe,GAAG,CAAC,CAAA,IAAK,CAAC;YAAE,OAAO,EAAE,KAAK;YAAE,QAAQ,EAAE,MAAM;YAAE,OAAO,EAAE,KAAK;YAAE,MAAM,EAAE,IAAI;QAAC,CAAC,IAAI,MAAM,GAAG;AACzH,CAAC;IAEG,IAAI;QACA,MAAM,WAAW,MAAM,MAAM,aAAa;YACtC,QAAQ;YACR,SAAS;gBACL,gBAAgB;YACpB;YACA,MAAM,KAAK,SAAS,CAAC;gBACjB,OAAO;gBACP,cAAc;gBACd,UAAU;YACd;QACJ;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAEhC,IAAI,KAAK,KAAK,EAAE;YACZ,QAAQ,KAAK,CAAC,aAAa,KAAK,KAAK;YACrC,OAAO,CAAC,yBAAyB,EAAE,KAAK,KAAK,CAAC,OAAO,IAAI,KAAK,KAAK,IAAI,oBAAoB,uCAAuC,CAAC;QACvI;QAEA,OAAO,KAAK,OAAO,EAAE,CAAC,EAAE,EAAE,SAAS,WAAW;IAClD,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO;IACX;AACJ"}},
    {"offset": {"line": 1438, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vango/OneDrive/Documents/probandoanti/jes-vite/src/components/PurchaseTerminal.jsx"],"sourcesContent":["import { useRef, useEffect, useState } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { useCart } from '../context/CartContext';\r\nimport { getProducts } from '../services/shopify';\r\nimport { chatWithAI } from '../services/ai';\r\nimport Fuse from 'fuse.js';\r\n\r\nexport default function PurchaseTerminal({ isOpen, onClose, product }) {\r\n    const [history, setHistory] = useState([\r\n        { text: 'JES STORE - TERMINAL v1.0.4', type: 'system' },\r\n        { text: 'Conectando con la bodega central...', type: 'system' },\r\n        { text: 'ESTADO: ONLINE', type: 'success' },\r\n        { text: 'Escribe \"help\" para ver comandos o \"jarvis\" para hablar con la IA.', type: 'info' }\r\n    ]);\r\n    const [input, setInput] = useState('');\r\n    const inputRef = useRef(null);\r\n    const scrollRef = useRef(null);\r\n    const { addToCart, removeFromCart } = useCart();\r\n\r\n    useEffect(() => {\r\n        if (isOpen && inputRef.current) {\r\n            inputRef.current.focus();\r\n        }\r\n    }, [isOpen]);\r\n\r\n    useEffect(() => {\r\n        if (scrollRef.current) {\r\n            scrollRef.current.scrollTop = scrollRef.current.scrollHeight;\r\n        }\r\n    }, [history]);\r\n\r\n    const [pendingAction, setPendingAction] = useState(null);\r\n    const [suggestedProduct, setSuggestedProduct] = useState(null);\r\n    const [jarvisMode, setJarvisMode] = useState(false);\r\n    const [jarvisHistory, setJarvisHistory] = useState([]);\r\n\r\n    const handleCommand = async (e) => {\r\n        if (e.key === 'Enter') {\r\n            const cmdText = input.trim().toLowerCase();\r\n            const newHistory = [...history, { text: `> ${input}`, type: 'user' }];\r\n\r\n            // Handle Pending Confirmations (y/n)\r\n            if (pendingAction === 'confirm_buy') {\r\n                if (cmdText === 'y' || cmdText === 'yes') {\r\n                    if (suggestedProduct) {\r\n                        addToCart({\r\n                            handle: suggestedProduct.handle,\r\n                            title: suggestedProduct.title,\r\n                            price: suggestedProduct.price,\r\n                            image: suggestedProduct.image\r\n                        });\r\n                        newHistory.push({ text: `[SUCCESS] ${suggestedProduct.title} aÃ±adido al carrito.`, type: 'success' });\r\n                    }\r\n                } else {\r\n                    newHistory.push({ text: 'OperaciÃ³n cancelada.', type: 'system' });\r\n                }\r\n                setPendingAction(null);\r\n                setSuggestedProduct(null);\r\n                setHistory(newHistory);\r\n                setInput('');\r\n                return;\r\n            }\r\n\r\n            if (cmdText === 'help') {\r\n                newHistory.push({ text: 'COMANDOS DISPONIBLES:', type: 'info' });\r\n                newHistory.push({ text: '  jarvis         - Activar modo JARVIS (IA)', type: 'success' });\r\n                newHistory.push({ text: '  search <query> - Buscar productos y aÃ±adir al carrito', type: 'info' });\r\n                newHistory.push({ text: '  buy            - Comprar producto actual (si hay uno activo)', type: 'info' });\r\n                newHistory.push({ text: '  stats          - EstadÃ­sticas del sistema', type: 'info' });\r\n                newHistory.push({ text: '  scan           - Escanear vulnerabilidades de ofertas', type: 'info' });\r\n                newHistory.push({ text: '  clear          - Limpiar la consola', type: 'info' });\r\n                newHistory.push({ text: '  exit           - Cerrar terminal', type: 'info' });\r\n            } else if (cmdText === 'jarvis') {\r\n                setJarvisMode(true);\r\n                setJarvisHistory([]);\r\n                newHistory.push({ text: '', type: 'system' });\r\n                newHistory.push({ text: 'â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—', type: 'success' });\r\n                newHistory.push({ text: 'â•‘         J.A.R.V.I.S. INTERFACE ACTIVATED              â•‘', type: 'success' });\r\n                newHistory.push({ text: 'â•‘   Just A Rather Very Intelligent System               â•‘', type: 'success' });\r\n                newHistory.push({ text: 'â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', type: 'success' });\r\n                newHistory.push({ text: '', type: 'system' });\r\n                newHistory.push({ text: 'Hola. Soy JARVIS, tu asistente personal de JES Store.', type: 'info' });\r\n                newHistory.push({ text: 'Puedo ayudarte a encontrar productos, responder preguntas', type: 'info' });\r\n                newHistory.push({ text: 'o simplemente conversar. Escribe \"exit\" para salir del modo JARVIS.', type: 'info' });\r\n                newHistory.push({ text: '', type: 'system' });\r\n            } else if (cmdText.startsWith('search ')) {\r\n                const query = cmdText.replace('search ', '').trim();\r\n                newHistory.push({ text: `Buscando \"${query}\" en los servidores de Shopify...`, type: 'system' });\r\n\r\n                try {\r\n                    const allProducts = await getProducts(100);\r\n                    const fuse = new Fuse(allProducts, {\r\n                        keys: [\r\n                            { name: 'title', weight: 0.7 },\r\n                            { name: 'type', weight: 0.2 },\r\n                            { name: 'tags', weight: 0.1 }\r\n                        ],\r\n                        threshold: 0.5,\r\n                        distance: 100\r\n                    });\r\n                    const results = fuse.search(query).map(r => r.item).slice(0, 3);\r\n\r\n                    if (results.length > 0) {\r\n                        newHistory.push({ text: `ENCONTRADO: ${results[0].title} (${results[0].price})`, type: 'info' });\r\n                        newHistory.push({ text: `Â¿AÃ±adir al carrito? (y/n)`, type: 'user' });\r\n                        setSuggestedProduct(results[0]);\r\n                        setPendingAction('confirm_buy');\r\n                    } else {\r\n                        newHistory.push({ text: `[ERROR] No se encontraron productos para \"${query}\".`, type: 'error' });\r\n                    }\r\n                } catch (err) {\r\n                    newHistory.push({ text: '[FATAL] Error de conexiÃ³n con la base de datos.', type: 'error' });\r\n                }\r\n            } else if (cmdText === 'buy') {\r\n                if (product) {\r\n                    newHistory.push({ text: `Iniciando protocolo de compra para: ${product.title}...`, type: 'system' });\r\n                    setTimeout(() => {\r\n                        addToCart({\r\n                            handle: product.handle,\r\n                            title: product.title,\r\n                            price: product.price,\r\n                            image: product.image || (product.images && product.images[0])\r\n                        });\r\n                        setHistory(prev => [...prev, { text: 'PRODUCTO AÃ‘ADIDO AL CARRITO CON Ã‰XITO.', type: 'success' }]);\r\n                    }, 1000);\r\n                } else {\r\n                    newHistory.push({ text: 'Error: No hay un producto activo. Usa \"search <nombre>\" primero.', type: 'error' });\r\n                }\r\n            } else if (cmdText === 'stats') {\r\n                newHistory.push({ text: 'ESTADÃSTICAS DE LA COMUNIDAD:', type: 'info' });\r\n                newHistory.push({ text: '  Usuarios Online: 1,420', type: 'info' });\r\n                newHistory.push({ text: '  Vibe Level: 100%', type: 'info' });\r\n            } else if (cmdText === 'scan') {\r\n                newHistory.push({ text: 'Escaneando vulnerabilidades...', type: 'user' });\r\n                setTimeout(() => {\r\n                    setHistory(prev => [...prev, { text: 'Â¡CUPÃ“N DETECTADO! Usa \"JES20\" para un 20% off.', type: 'success' }]);\r\n                }, 1500);\r\n            } else if (cmdText === 'info') {\r\n                if (product) {\r\n                    newHistory.push({ text: `PRODUCTO: ${product.title}`, type: 'info' });\r\n                    newHistory.push({ text: `PRECIO: ${product.price}`, type: 'info' });\r\n                } else {\r\n                    newHistory.push({ text: 'Error: No hay producto activo.', type: 'error' });\r\n                }\r\n            } else if (cmdText === 'clear') {\r\n                setHistory([{ text: 'Consola despejada.', type: 'system' }]);\r\n                setInput('');\r\n                return;\r\n            } else if (cmdText === 'exit') {\r\n                if (jarvisMode) {\r\n                    setJarvisMode(false);\r\n                    newHistory.push({ text: 'JARVIS desactivado. Volviendo al modo terminal.', type: 'system' });\r\n                } else {\r\n                    onClose();\r\n                    return;\r\n                }\r\n            } else if (jarvisMode && cmdText !== '') {\r\n                // JARVIS Mode - Send to AI\r\n                newHistory.push({ text: 'JARVIS > Procesando...', type: 'info' });\r\n                setHistory(newHistory);\r\n                setInput('');\r\n\r\n                try {\r\n                    // Fetch products for context\r\n                    const allProducts = await getProducts(50);\r\n                    const newJarvisHistory = [...jarvisHistory, { role: 'user', content: input }];\r\n                    const response = await chatWithAI(newJarvisHistory, allProducts);\r\n                    setJarvisHistory([...newJarvisHistory, { role: 'assistant', content: response }]);\r\n\r\n                    // Process JARVIS commands in response\r\n                    const addCartMatch = response.match(/\\[ADD_CART:([^\\]]+)\\]/);\r\n                    const removeCartMatch = response.match(/\\[REMOVE_CART:([^\\]]+)\\]/);\r\n\r\n                    if (addCartMatch) {\r\n                        const handle = addCartMatch[1];\r\n                        const productToAdd = allProducts.find(p => p.handle === handle);\r\n                        if (productToAdd) {\r\n                            addToCart({\r\n                                handle: productToAdd.handle,\r\n                                title: productToAdd.title,\r\n                                price: productToAdd.price,\r\n                                image: productToAdd.image\r\n                            });\r\n                        }\r\n                    }\r\n\r\n                    if (removeCartMatch) {\r\n                        const handle = removeCartMatch[1];\r\n                        removeFromCart(handle);\r\n                    }\r\n\r\n                    // Clean response from commands for display\r\n                    const cleanResponse = response\r\n                        .replace(/\\[ADD_CART:[^\\]]+\\]/g, 'âœ… AÃ±adido al carrito')\r\n                        .replace(/\\[REMOVE_CART:[^\\]]+\\]/g, 'âŒ Eliminado del carrito')\r\n                        .replace(/\\[PRODUCT:[^\\]]+\\]/g, '')\r\n                        .replace(/\\[SEARCH:[^\\]]+\\]/g, '');\r\n\r\n                    // Split response into lines for terminal display\r\n                    const lines = cleanResponse.split('\\n').filter(l => l.trim());\r\n                    setHistory(prev => [\r\n                        ...prev.filter(h => h.text !== 'JARVIS > Procesando...'),\r\n                        { text: 'JARVIS:', type: 'success' },\r\n                        ...lines.map(line => ({ text: `  ${line}`, type: 'info' })),\r\n                        { text: '', type: 'system' }\r\n                    ]);\r\n                } catch (err) {\r\n                    setHistory(prev => [\r\n                        ...prev.filter(h => h.text !== 'JARVIS > Procesando...'),\r\n                        { text: '[ERROR] No se pudo conectar con JARVIS.', type: 'error' }\r\n                    ]);\r\n                }\r\n                return;\r\n            } else if (cmdText !== '') {\r\n                newHistory.push({ text: `Error: Comando desconocido. Escribe \"help\".`, type: 'error' });\r\n            }\r\n\r\n            setHistory(newHistory);\r\n            setInput('');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <AnimatePresence>\r\n            {isOpen && (\r\n                <motion.div\r\n                    initial={{ opacity: 0 }}\r\n                    animate={{ opacity: 1 }}\r\n                    exit={{ opacity: 0 }}\r\n                    className=\"fixed inset-0 z-[100] bg-black/90 backdrop-blur-md flex items-center justify-center p-4 md:p-10 font-mono\"\r\n                >\r\n                    <motion.div\r\n                        initial={{ scale: 0.9, y: 20 }}\r\n                        animate={{ scale: 1, y: 0 }}\r\n                        className=\"w-full max-w-4xl h-[600px] bg-zinc-950 border border-green-500/30 rounded-lg shadow-[0_0_50px_rgba(34,197,94,0.1)] flex flex-col overflow-hidden relative\"\r\n                    >\r\n                        {/* CRT Effect Overlay */}\r\n                        <div className=\"absolute inset-0 pointer-events-none bg-[radial-gradient(rgba(18,16,16,0)_50%,rgba(0,0,0,0.25)_100%),linear-gradient(rgba(18,16,16,0)_50%,rgba(0,0,0,0.1)_50%),linear-gradient(90deg,rgba(255,0,0,0.06),rgba(0,255,0,0.02),rgba(0,0,255,0.06))] bg-[length:100%_2px,100%_1px,3px_100%] z-10\" />\r\n\r\n                        {/* Terminal Header */}\r\n                        <div className=\"flex items-center justify-between px-4 py-2 bg-zinc-900 border-b border-green-500/20\">\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <div className=\"w-3 h-3 rounded-full bg-red-500/50\" />\r\n                                <div className=\"w-3 h-3 rounded-full bg-yellow-500/50\" />\r\n                                <div className=\"w-3 h-3 rounded-full bg-green-500/50\" />\r\n                                <span className=\"ml-2 text-[10px] text-green-500/50 uppercase tracking-widest\">jes_terminal_v1.sh</span>\r\n                            </div>\r\n                            <button onClick={onClose} className=\"text-green-500/50 hover:text-green-500 transition-colors\">\r\n                                [X]\r\n                            </button>\r\n                        </div>\r\n\r\n                        {/* Terminal Content */}\r\n                        <div\r\n                            ref={scrollRef}\r\n                            className=\"flex-1 p-6 overflow-y-auto space-y-2 text-sm md:text-base selection:bg-green-500/30 selection:text-white no-scrollbar\"\r\n                        >\r\n                            {history.map((line, i) => (\r\n                                <div key={i} className={`\r\n                                    ${line.type === 'system' ? 'text-green-500/70' : ''}\r\n                                    ${line.type === 'success' ? 'text-green-400 font-bold' : ''}\r\n                                    ${line.type === 'error' ? 'text-red-400' : ''}\r\n                                    ${line.type === 'info' ? 'text-blue-400' : ''}\r\n                                    ${line.type === 'user' ? 'text-white' : ''}\r\n                                `}>\r\n                                    {line.text}\r\n                                </div>\r\n                            ))}\r\n                            <div className=\"flex items-center gap-2 text-green-400\">\r\n                                <span>$</span>\r\n                                <input\r\n                                    ref={inputRef}\r\n                                    type=\"text\"\r\n                                    value={input}\r\n                                    onChange={(e) => setInput(e.target.value)}\r\n                                    onKeyDown={handleCommand}\r\n                                    className=\"flex-1 bg-transparent border-none outline-none caret-green-500 p-0 text-white\"\r\n                                    autoFocus\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Status Bar */}\r\n                        <div className=\"px-4 py-1 bg-green-500/10 border-t border-green-500/20 flex justify-between text-[10px] text-green-500/50 uppercase tracking-tighter\">\r\n                            <span>Status: Root_Access</span>\r\n                            <span> {product ? `Target: ${product.handle}` : 'System_Idle'}</span>\r\n                            <span>UTF-8</span>\r\n                        </div>\r\n                    </motion.div>\r\n                </motion.div>\r\n            )}\r\n        </AnimatePresence>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2045, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vango/OneDrive/Documents/probandoanti/jes-vite/src/components/AIAssistant.jsx"],"sourcesContent":["'use client';\r\nimport { useState, useEffect, useRef } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport Link from 'next/link';\r\nimport { usePathname } from 'next/navigation';\r\nimport { chatWithAI } from '../services/ai';\r\nimport { getProducts } from '../services/shopify';\r\n\r\nexport default function AIAssistant({ isFullScreen = false }) {\r\n    const [isOpen, setIsOpen] = useState(isFullScreen);\r\n    const [messages, setMessages] = useState(() => {\r\n        const saved = localStorage.getItem('jarvis-history');\r\n        if (saved) return JSON.parse(saved);\r\n        return [\r\n            { role: 'assistant', content: 'Hola. Soy JARVIS, tu asistente personal de JES Store. Â¿En quÃ© puedo ayudarte hoy?' }\r\n        ];\r\n    });\r\n    const [input, setInput] = useState('');\r\n    const [loading, setLoading] = useState(false);\r\n    const [products, setProducts] = useState([]);\r\n    const scrollRef = useRef(null);\r\n    const pathname = usePathname();\r\n\r\n    useEffect(() => {\r\n        localStorage.setItem('jarvis-history', JSON.stringify(messages));\r\n    }, [messages]);\r\n\r\n    useEffect(() => {\r\n        async function loadContext() {\r\n            try {\r\n                const data = await getProducts(20);\r\n                setProducts(data);\r\n            } catch (e) {\r\n                console.warn(\"Could not load products for AI context\");\r\n            }\r\n        }\r\n        loadContext();\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (isFullScreen) return;\r\n        const handleOpen = () => setIsOpen(true);\r\n        const handleToggle = () => setIsOpen(prev => !prev);\r\n        window.addEventListener('open-ai-assistant', handleOpen);\r\n        window.addEventListener('toggle-ai', handleToggle);\r\n        return () => {\r\n            window.removeEventListener('open-ai-assistant', handleOpen);\r\n            window.removeEventListener('toggle-ai', handleToggle);\r\n        };\r\n    }, [isFullScreen]);\r\n\r\n    useEffect(() => {\r\n        if (scrollRef.current) {\r\n            scrollRef.current.scrollTop = scrollRef.current.scrollHeight;\r\n        }\r\n    }, [messages]);\r\n\r\n    const handleSend = async () => {\r\n        if (!input.trim() || loading) return;\r\n\r\n        const userMsg = { role: 'user', content: input };\r\n        setMessages(prev => [...prev, userMsg]);\r\n        setInput('');\r\n        setLoading(true);\r\n\r\n        try {\r\n            const response = await chatWithAI([...messages, userMsg], products);\r\n            setMessages(prev => [...prev, { role: 'assistant', content: response }]);\r\n            setLoading(false);\r\n        } catch (error) {\r\n            console.error(\"Chat error:\", error);\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const renderMessageContent = (content) => {\r\n        const productRegex = /\\[PRODUCT:(.+?)\\]/g;\r\n        const matches = [...content.matchAll(productRegex)];\r\n        const cleanContent = content.replace(productRegex, '').trim();\r\n\r\n        return (\r\n            <div className=\"space-y-4\">\r\n                <p>{cleanContent}</p>\r\n                {matches.length > 0 && (\r\n                    <div className=\"pt-2 flex flex-wrap gap-2\">\r\n                        {matches.map((match, idx) => {\r\n                            const handle = match[1];\r\n                            return (\r\n                                <Link\r\n                                    key={idx}\r\n                                    href={`/product/${handle}`}\r\n                                    className=\"inline-flex items-center gap-2 px-4 py-2.5 bg-zinc-50 dark:bg-white text-zinc-900 dark:text-black rounded-full font-bold text-[10px] hover:scale-105 active:scale-95 transition-all shadow-xl border border-black/5\"\r\n                                >\r\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"3\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M7 7h10v10\" /><path d=\"M7 17 17 7\" /></svg>\r\n                                    Ver Producto\r\n                                </Link>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                )}\r\n            </div>\r\n        );\r\n    };\r\n\r\n    const chatContent = (\r\n        <motion.div\r\n            initial={!isFullScreen ? { opacity: 0, scale: 0.8, y: 20, transformOrigin: 'bottom right' } : { opacity: 0 }}\r\n            animate={{ opacity: 1, scale: 1, y: 0 }}\r\n            exit={{ opacity: 0, scale: 0.8, y: 20 }}\r\n            className={`${isFullScreen\r\n                ? 'w-full h-full flex flex-col bg-white dark:bg-black transition-colors duration-300'\r\n                : 'absolute bottom-20 right-0 w-[320px] md:w-[350px] h-[480px] bg-white/95 dark:bg-zinc-950/95 border border-black/10 dark:border-white/10 rounded-[32px] overflow-hidden shadow-[0_20px_60px_rgba(0,0,0,0.1)] dark:shadow-[0_20px_60px_rgba(0,0,0,0.5)] flex flex-col backdrop-blur-2xl transition-all duration-300'\r\n                }`}\r\n        >\r\n            {/* Header Premium */}\r\n            <div className=\"p-7 bg-black dark:bg-white text-white dark:text-black flex items-center justify-between shrink-0 transition-colors duration-300\">\r\n                <div className=\"flex items-center gap-3\">\r\n                    <div className=\"w-10 h-10 bg-blue-600 dark:bg-blue-600 rounded-2xl flex items-center justify-center text-xl shadow-inner border border-white/5 dark:border-black/5 shrink-0 transition-colors duration-300\">\r\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"white\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n                            <path d=\"M12 8V4H8\" />\r\n                            <rect width=\"16\" height=\"12\" x=\"4\" y=\"8\" rx=\"2\" />\r\n                            <path d=\"M2 14h2\" />\r\n                            <path d=\"M20 14h2\" />\r\n                            <path d=\"M15 13v2\" />\r\n                            <path d=\"M9 13v2\" />\r\n                        </svg>\r\n                    </div>\r\n                    <div className=\"min-w-0\">\r\n                        <h3 className=\"text-white dark:text-black font-black uppercase tracking-tighter text-base md:text-lg leading-none truncate transition-colors duration-300\">JARVIS</h3>\r\n                        <p className=\"text-white/50 dark:text-black/50 text-[9px] md:text-[10px] font-bold uppercase tracking-widest mt-1 truncate transition-colors duration-300\">Asistente Virtual JES</p>\r\n                    </div>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                    {!isFullScreen && (\r\n                        <button\r\n                            onClick={() => setIsOpen(false)}\r\n                            className=\"p-2.5 hover:bg-white/10 dark:hover:bg-black/5 text-white dark:text-black rounded-xl transition-colors\"\r\n                        >\r\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M18 6 6 18\" /><path d=\"m6 6 12 12\" /></svg>\r\n                        </button>\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            <div\r\n                ref={scrollRef}\r\n                className=\"flex-1 overflow-y-auto p-6 space-y-6 custom-scrollbar bg-transparent\"\r\n            >\r\n                {messages.map((m, i) => (\r\n                    <div key={i} className={`flex ${m.role === 'user' ? 'justify-end' : 'justify-start'}`}>\r\n                        <div className={`max-w-[85%] p-5 rounded-[28px] text-sm leading-relaxed transition-all duration-300 ${m.role === 'user'\r\n                            ? 'bg-blue-600 text-white rounded-tr-none shadow-lg shadow-blue-500/20'\r\n                            : 'bg-zinc-100 dark:bg-white/5 text-zinc-900 dark:text-zinc-100 border border-black/5 dark:border-white/5 rounded-tl-none shadow-sm'\r\n                            }`}>\r\n                            {m.role === 'assistant' ? renderMessageContent(m.content) : m.content}\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n                {loading && (\r\n                    <div className=\"flex justify-start pl-2\">\r\n                        <div className=\"bg-zinc-100 dark:bg-white/5 px-6 py-4 rounded-[28px] rounded-tl-none border border-black/5 dark:border-white/5 transition-colors duration-300\">\r\n                            <div className=\"flex gap-1.5\">\r\n                                <span className=\"w-2 h-2 bg-black/40 dark:bg-white/40 rounded-full animate-bounce\"></span>\r\n                                <span className=\"w-2 h-2 bg-black/40 dark:bg-white/40 rounded-full animate-bounce [animation-delay:0.2s]\"></span>\r\n                                <span className=\"w-2 h-2 bg-black/40 dark:bg-white/40 rounded-full animate-bounce [animation-delay:0.4s]\"></span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Input Premium */}\r\n            <div className={`p-6 border-t border-black/5 dark:border-white/5 bg-zinc-50/50 dark:bg-black/20 transition-colors duration-300 ${isFullScreen ? 'pb-24' : ''}`}>\r\n                <div className=\"flex items-center gap-3 bg-zinc-100 dark:bg-white/5 rounded-[24px] p-2 pr-2 border border-black/10 dark:border-white/5 focus-within:border-blue-500 transition-all shadow-inner\">\r\n                    <input\r\n                        type=\"text\"\r\n                        value={input}\r\n                        onChange={(e) => setInput(e.target.value)}\r\n                        onKeyDown={(e) => e.key === 'Enter' && handleSend()}\r\n                        placeholder=\"Escribe aquÃ­...\"\r\n                        className=\"bg-transparent border-none outline-none text-zinc-900 dark:text-white placeholder:text-zinc-400 dark:placeholder:text-zinc-600 text-base w-full px-4 transition-colors duration-300\"\r\n                    />\r\n                    <button\r\n                        onClick={handleSend}\r\n                        disabled={loading || !input.trim()}\r\n                        className=\"w-12 h-12 bg-black dark:bg-white text-white dark:text-black rounded-2xl flex items-center justify-center hover:scale-105 active:scale-95 disabled:opacity-30 disabled:hover:scale-100 transition-all shadow-lg shrink-0\"\r\n                    >\r\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"m22 2-7 20-4-9-9-4Z\" /><path d=\"M22 2 11 13\" /></svg>\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </motion.div>\r\n    );\r\n\r\n    if (pathname === '/ai' && !isFullScreen) return null;\r\n    if (isFullScreen) return chatContent;\r\n\r\n    return (\r\n        <div className=\"fixed bottom-6 right-6 z-[60]\">\r\n            {/* Toggle Button - Only visible on desktop if drawer is closed */}\r\n            <motion.button\r\n                whileHover={{ scale: 1.1, y: -2 }}\r\n                whileTap={{ scale: 0.9 }}\r\n                onClick={() => setIsOpen(!isOpen)}\r\n                className={`w-14 h-14 bg-blue-600 dark:bg-white rounded-full flex items-center justify-center shadow-[0_10px_30px_rgba(59,130,246,0.3)] dark:shadow-[0_10px_30px_rgba(255,255,255,0.15)] text-white dark:text-black relative z-10 border border-blue-500 dark:border-white/20 hover:bg-blue-700 dark:hover:bg-zinc-100 transition-colors ${isOpen ? 'hidden md:flex' : 'hidden md:flex'}`}\r\n            >\r\n                {isOpen ? (\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M18 6 6 18\" /><path d=\"m6 6 12 12\" /></svg>\r\n                ) : (\r\n                    <div className=\"relative\">\r\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\" /></svg>\r\n                        {!isOpen && <span className=\"absolute -top-1 -right-1 w-3 h-3 bg-blue-600 rounded-full border-2 border-white animate-pulse\"></span>}\r\n                    </div>\r\n                )}\r\n            </motion.button>\r\n\r\n            <AnimatePresence>\r\n                {isOpen && chatContent}\r\n            </AnimatePresence>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;;;AANA;;;;;;;AAQe,SAAS,YAAY,EAAE,eAAe,KAAK,EAAE;;IACxD,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAC;IACrC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ;gCAAC;YACrC,MAAM,QAAQ,aAAa,OAAO,CAAC;YACnC,IAAI,OAAO,OAAO,KAAK,KAAK,CAAC;YAC7B,OAAO;gBACH;oBAAE,MAAM;oBAAa,SAAS;gBAAoF;aACrH;QACL;;IACA,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IACnC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC,EAAE;IAC3C,MAAM,YAAY,IAAA,uKAAM,EAAC;IACzB,MAAM,WAAW,IAAA,oJAAW;IAE5B,IAAA,0KAAS;iCAAC;YACN,aAAa,OAAO,CAAC,kBAAkB,KAAK,SAAS,CAAC;QAC1D;gCAAG;QAAC;KAAS;IAEb,IAAA,0KAAS;iCAAC;YACN,eAAe;gBACX,IAAI;oBACA,MAAM,OAAO,MAAM,IAAA,4IAAW,EAAC;oBAC/B,YAAY;gBAChB,EAAE,OAAO,GAAG;oBACR,QAAQ,IAAI,CAAC;gBACjB;YACJ;YACA;QACJ;gCAAG,EAAE;IAEL,IAAA,0KAAS;iCAAC;YACN,IAAI,cAAc;YAClB,MAAM;oDAAa,IAAM,UAAU;;YACnC,MAAM;sDAAe,IAAM;8DAAU,CAAA,OAAQ,CAAC;;;YAC9C,OAAO,gBAAgB,CAAC,qBAAqB;YAC7C,OAAO,gBAAgB,CAAC,aAAa;YACrC;yCAAO;oBACH,OAAO,mBAAmB,CAAC,qBAAqB;oBAChD,OAAO,mBAAmB,CAAC,aAAa;gBAC5C;;QACJ;gCAAG;QAAC;KAAa;IAEjB,IAAA,0KAAS;iCAAC;YACN,IAAI,UAAU,OAAO,EAAE;gBACnB,UAAU,OAAO,CAAC,SAAS,GAAG,UAAU,OAAO,CAAC,YAAY;YAChE;QACJ;gCAAG;QAAC;KAAS;IAEb,MAAM,aAAa;QACf,IAAI,CAAC,MAAM,IAAI,MAAM,SAAS;QAE9B,MAAM,UAAU;YAAE,MAAM;YAAQ,SAAS;QAAM;QAC/C,YAAY,CAAA,OAAQ;mBAAI;gBAAM;aAAQ;QACtC,SAAS;QACT,WAAW;QAEX,IAAI;YACA,MAAM,WAAW,MAAM,IAAA,sIAAU,EAAC;mBAAI;gBAAU;aAAQ,EAAE;YAC1D,YAAY,CAAA,OAAQ;uBAAI;oBAAM;wBAAE,MAAM;wBAAa,SAAS;oBAAS;iBAAE;YACvE,WAAW;QACf,EAAE,OAAO,OAAO;YACZ,QAAQ,KAAK,CAAC,eAAe;YAC7B,WAAW;QACf;IACJ;IAEA,MAAM,uBAAuB,CAAC;QAC1B,MAAM,eAAe;QACrB,MAAM,UAAU;eAAI,QAAQ,QAAQ,CAAC;SAAc;QACnD,MAAM,eAAe,QAAQ,OAAO,CAAC,cAAc,IAAI,IAAI;QAE3D,qBACI,6LAAC;YAAI,WAAU;;8BACX,6LAAC;8BAAG;;;;;;gBACH,QAAQ,MAAM,GAAG,mBACd,6LAAC;oBAAI,WAAU;8BACV,QAAQ,GAAG,CAAC,CAAC,OAAO;wBACjB,MAAM,SAAS,KAAK,CAAC,EAAE;wBACvB,qBACI,6LAAC,0KAAI;4BAED,MAAM,CAAC,SAAS,EAAE,QAAQ;4BAC1B,WAAU;;8CAEV,6LAAC;oCAAI,OAAM;oCAA6B,OAAM;oCAAK,QAAO;oCAAK,SAAQ;oCAAY,MAAK;oCAAO,QAAO;oCAAe,aAAY;oCAAI,eAAc;oCAAQ,gBAAe;;sDAAQ,6LAAC;4CAAK,GAAE;;;;;;sDAAe,6LAAC;4CAAK,GAAE;;;;;;;;;;;;gCAAqB;;2BAJjO;;;;;oBAQjB;;;;;;;;;;;;IAKpB;IAEA,MAAM,4BACF,6LAAC,uMAAM,CAAC,GAAG;QACP,SAAS,CAAC,eAAe;YAAE,SAAS;YAAG,OAAO;YAAK,GAAG;YAAI,iBAAiB;QAAe,IAAI;YAAE,SAAS;QAAE;QAC3G,SAAS;YAAE,SAAS;YAAG,OAAO;YAAG,GAAG;QAAE;QACtC,MAAM;YAAE,SAAS;YAAG,OAAO;YAAK,GAAG;QAAG;QACtC,WAAW,GAAG,eACR,sFACA,qTACA;;0BAGN,6LAAC;gBAAI,WAAU;;kCACX,6LAAC;wBAAI,WAAU;;0CACX,6LAAC;gCAAI,WAAU;0CACX,cAAA,6LAAC;oCAAI,OAAM;oCAA6B,OAAM;oCAAK,QAAO;oCAAK,SAAQ;oCAAY,MAAK;oCAAO,QAAO;oCAAQ,aAAY;oCAAI,eAAc;oCAAQ,gBAAe;;sDAC/J,6LAAC;4CAAK,GAAE;;;;;;sDACR,6LAAC;4CAAK,OAAM;4CAAK,QAAO;4CAAK,GAAE;4CAAI,GAAE;4CAAI,IAAG;;;;;;sDAC5C,6LAAC;4CAAK,GAAE;;;;;;sDACR,6LAAC;4CAAK,GAAE;;;;;;sDACR,6LAAC;4CAAK,GAAE;;;;;;sDACR,6LAAC;4CAAK,GAAE;;;;;;;;;;;;;;;;;0CAGhB,6LAAC;gCAAI,WAAU;;kDACX,6LAAC;wCAAG,WAAU;kDAA6I;;;;;;kDAC3J,6LAAC;wCAAE,WAAU;kDAA8I;;;;;;;;;;;;;;;;;;kCAGnK,6LAAC;wBAAI,WAAU;kCACV,CAAC,8BACE,6LAAC;4BACG,SAAS,IAAM,UAAU;4BACzB,WAAU;sCAEV,cAAA,6LAAC;gCAAI,OAAM;gCAA6B,OAAM;gCAAK,QAAO;gCAAK,SAAQ;gCAAY,MAAK;gCAAO,QAAO;gCAAe,aAAY;gCAAM,eAAc;gCAAQ,gBAAe;;kDAAQ,6LAAC;wCAAK,GAAE;;;;;;kDAAe,6LAAC;wCAAK,GAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAMnO,6LAAC;gBACG,KAAK;gBACL,WAAU;;oBAET,SAAS,GAAG,CAAC,CAAC,GAAG,kBACd,6LAAC;4BAAY,WAAW,CAAC,KAAK,EAAE,EAAE,IAAI,KAAK,SAAS,gBAAgB,iBAAiB;sCACjF,cAAA,6LAAC;gCAAI,WAAW,CAAC,mFAAmF,EAAE,EAAE,IAAI,KAAK,SAC3G,wEACA,oIACA;0CACD,EAAE,IAAI,KAAK,cAAc,qBAAqB,EAAE,OAAO,IAAI,EAAE,OAAO;;;;;;2BALnE;;;;;oBASb,yBACG,6LAAC;wBAAI,WAAU;kCACX,cAAA,6LAAC;4BAAI,WAAU;sCACX,cAAA,6LAAC;gCAAI,WAAU;;kDACX,6LAAC;wCAAK,WAAU;;;;;;kDAChB,6LAAC;wCAAK,WAAU;;;;;;kDAChB,6LAAC;wCAAK,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAQpC,6LAAC;gBAAI,WAAW,CAAC,8GAA8G,EAAE,eAAe,UAAU,IAAI;0BAC1J,cAAA,6LAAC;oBAAI,WAAU;;sCACX,6LAAC;4BACG,MAAK;4BACL,OAAO;4BACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;4BACxC,WAAW,CAAC,IAAM,EAAE,GAAG,KAAK,WAAW;4BACvC,aAAY;4BACZ,WAAU;;;;;;sCAEd,6LAAC;4BACG,SAAS;4BACT,UAAU,WAAW,CAAC,MAAM,IAAI;4BAChC,WAAU;sCAEV,cAAA,6LAAC;gCAAI,OAAM;gCAA6B,OAAM;gCAAK,QAAO;gCAAK,SAAQ;gCAAY,MAAK;gCAAO,QAAO;gCAAe,aAAY;gCAAM,eAAc;gCAAQ,gBAAe;;kDAAQ,6LAAC;wCAAK,GAAE;;;;;;kDAAwB,6LAAC;wCAAK,GAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAOhP,IAAI,aAAa,SAAS,CAAC,cAAc,OAAO;IAChD,IAAI,cAAc,OAAO;IAEzB,qBACI,6LAAC;QAAI,WAAU;;0BAEX,6LAAC,uMAAM,CAAC,MAAM;gBACV,YAAY;oBAAE,OAAO;oBAAK,GAAG,CAAC;gBAAE;gBAChC,UAAU;oBAAE,OAAO;gBAAI;gBACvB,SAAS,IAAM,UAAU,CAAC;gBAC1B,WAAW,CAAC,6TAA6T,EAAE,SAAS,mBAAmB,kBAAkB;0BAExX,uBACG,6LAAC;oBAAI,OAAM;oBAA6B,OAAM;oBAAK,QAAO;oBAAK,SAAQ;oBAAY,MAAK;oBAAO,QAAO;oBAAe,aAAY;oBAAM,eAAc;oBAAQ,gBAAe;;sCAAQ,6LAAC;4BAAK,GAAE;;;;;;sCAAe,6LAAC;4BAAK,GAAE;;;;;;;;;;;yCAEnN,6LAAC;oBAAI,WAAU;;sCACX,6LAAC;4BAAI,OAAM;4BAA6B,OAAM;4BAAK,QAAO;4BAAK,SAAQ;4BAAY,MAAK;4BAAO,QAAO;4BAAe,aAAY;4BAAI,eAAc;4BAAQ,gBAAe;sCAAQ,cAAA,6LAAC;gCAAK,GAAE;;;;;;;;;;;wBACzL,CAAC,wBAAU,6LAAC;4BAAK,WAAU;;;;;;;;;;;;;;;;;0BAKxC,6LAAC,+MAAe;0BACX,UAAU;;;;;;;;;;;;AAI3B;GArNwB;;QAaH,oJAAW;;;KAbR"}},
    {"offset": {"line": 2683, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vango/OneDrive/Documents/probandoanti/jes-vite/app/providers.js"],"sourcesContent":["'use client';\r\n\r\nimport { WishlistProvider } from '../src/context/WishlistContext';\r\nimport { CartProvider } from '../src/context/CartContext';\r\nimport { ThemeProvider } from '../src/context/ThemeContext';\r\nimport { TerminalProvider, useTerminal } from '../src/context/TerminalContext';\r\nimport PurchaseTerminal from '../src/components/PurchaseTerminal';\r\nimport AIAssistant from '../src/components/AIAssistant';\r\n\r\n// Wrapper component that has access to Terminal context\r\nfunction GlobalComponents({ children }) {\r\n    const { isOpen, closeTerminal, activeProduct } = useTerminal();\r\n\r\n    return (\r\n        <>\r\n            {children}\r\n            <PurchaseTerminal isOpen={isOpen} onClose={closeTerminal} product={activeProduct} />\r\n            <AIAssistant />\r\n        </>\r\n    );\r\n}\r\n\r\nexport function Providers({ children }) {\r\n    return (\r\n        <ThemeProvider>\r\n            <WishlistProvider>\r\n                <CartProvider>\r\n                    <TerminalProvider>\r\n                        <GlobalComponents>\r\n                            {children}\r\n                        </GlobalComponents>\r\n                    </TerminalProvider>\r\n                </CartProvider>\r\n            </WishlistProvider>\r\n        </ThemeProvider>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAPA;;;;;;;AASA,wDAAwD;AACxD,SAAS,iBAAiB,EAAE,QAAQ,EAAE;;IAClC,MAAM,EAAE,MAAM,EAAE,aAAa,EAAE,aAAa,EAAE,GAAG,IAAA,oJAAW;IAE5D,qBACI;;YACK;0BACD,6LAAC,oJAAgB;gBAAC,QAAQ;gBAAQ,SAAS;gBAAe,SAAS;;;;;;0BACnE,6LAAC,+IAAW;;;;;;;AAGxB;GAVS;;QAC4C,oJAAW;;;KADvD;AAYF,SAAS,UAAU,EAAE,QAAQ,EAAE;IAClC,qBACI,6LAAC,mJAAa;kBACV,cAAA,6LAAC,yJAAgB;sBACb,cAAA,6LAAC,iJAAY;0BACT,cAAA,6LAAC,yJAAgB;8BACb,cAAA,6LAAC;kCACI;;;;;;;;;;;;;;;;;;;;;;;;;;AAO7B;MAdgB"}}]
}